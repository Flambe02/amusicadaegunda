var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,n=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&i(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&i(e,a,s[a]);return e},o=(e,t)=>s(e,a(t)),c=(e,s)=>{var a={};for(var i in e)r.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&t)for(var i of t(e))s.indexOf(i)<0&&l.call(e,i)&&(a[i]=e[i]);return a},d=(e,s,a)=>new Promise((t,r)=>{var l=e=>{try{n(a.next(e))}catch(s){r(s)}},i=e=>{try{n(a.throw(e))}catch(s){r(s)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,i);n((a=a.apply(e,s)).next())});import{r as m,j as u,W as x,K as h,Y as p,C as g,Z as b,N as f,_ as j,$ as v,a0 as N,a1 as y,v as k,a2 as w,a3 as _,a4 as S,M as T,f as C,a5 as E,X as M,c as D,a6 as I,a7 as L,a8 as A,a9 as $,b as R,aa as P,U as O,ab as z,ac as U,ad as V,t as q}from"./vendor-BIbFW3qO.js";import{e as B,l as F,S as H,B as Y,s as G}from"./index-DetkHvaz.js";import{I as J}from"./input-CnyY7bhd.js";import{B as K,S as W,a as Z,b as Q,c as X,d as ee}from"./badge-CwSYczGe.js";import{C as se,a as ae,b as te,c as re,d as le}from"./card-7icCX0xp.js";import{s as ie,a as ne,b as oe,c as ce,A as de,d as me,L as ue}from"./Login-BgkpJzIH.js";import{y as xe}from"./libs-DY7TBn7z.js";import{f as he,p as pe,a as ge}from"./utils-DuUtq9wc.js";import"./ui-CttiZxwU.js";import"./supabase-sfbdw4k8.js";const be=m.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx("textarea",n({className:B("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s},r))});function fe({postId:e,className:s="",song:a=null,fallbackVideoUrl:t=null}){const[r,l]=m.useState(!0),[i,c]=m.useState(null),[d,x]=m.useState(0),[j,v]=m.useState(0),[N,y]=m.useState(!1),[k,w]=m.useState(!0),[_,S]=m.useState(!0),[T,C]=m.useState(!1),[E,M]=m.useState(!1),[D,I]=m.useState({startTime:null,tiktokLoadTime:null,fallbackActivated:!1,totalLoadTime:null}),L=m.useRef(null),A=m.useRef(null),$=m.useRef(null),R=m.useRef(null),P=m.useRef(null),O=15e3,z=m.useCallback(()=>{$.current&&(window.clearTimeout($.current),$.current=null)},[]);m.useEffect(()=>{if(A.current)return R.current=new IntersectionObserver(([e])=>{var s;e.isIntersecting&&(y(!0),null==(s=R.current)||s.disconnect())},{threshold:.1,rootMargin:"50px"}),R.current.observe(A.current),()=>{var e;null==(e=R.current)||e.disconnect()}},[]),m.useEffect(()=>{if(!e||!N)return;const s=performance.now();return I(e=>o(n({},e),{startTime:s,tiktokLoadTime:null,fallbackActivated:!1,totalLoadTime:null})),l(!0),c(null),x(0),v(e=>e+1),w(!0),S(!0),C(!1),M(!1),z(),$.current=window.setTimeout(()=>{V("Timeout: Chargement trop lent")},O),z},[e,N,z]);const U=m.useCallback(()=>{const e=performance.now()-(D.startTime||0);z(),l(!1),c(null),w(!0),S(!0),I(s=>o(n({},s),{tiktokLoadTime:e,totalLoadTime:e}))},[z,D.startTime]),V=m.useCallback((e="Erro ao carregar v√≠deo TikTok")=>{if(z(),d<3)setTimeout(()=>{x(e=>e+1),v(e=>e+1),l(!0),c(null),$.current=window.setTimeout(()=>{V("Timeout: Retry √©chou√©")},O)},1e3);else{M(!0),c("TikTok indispon√≠vel - usando fallback"),l(!1);const e=performance.now()-(D.startTime||0);I(s=>o(n({},s),{fallbackActivated:!0,totalLoadTime:e}))}},[d,3,1e3,O,z,D.startTime]),q=m.useCallback(()=>{x(0),c(null),M(!1),v(e=>e+1),l(!0),$.current=window.setTimeout(()=>{V("Timeout: Retry manuel √©chou√©")},O)},[V,O]);m.useCallback(()=>{P.current&&(P.current.paused?(P.current.play(),C(!0)):(P.current.pause(),C(!1)))},[]);const B=m.useCallback(()=>{w(!1),S(!1)},[]),F=m.useCallback(()=>{(null==a?void 0:a.tiktok_url)&&window.open(a.tiktok_url,"_blank")},[a]);return m.useEffect(()=>()=>{z(),R.current&&R.current.disconnect()},[z]),N?E?u.jsx("div",{className:`${s} bg-black rounded-lg overflow-hidden`,style:{aspectRatio:"9/16"},children:u.jsxs("div",{className:"relative w-full h-full",children:[u.jsxs("video",{ref:P,className:"w-full h-full object-cover",controls:!0,preload:"metadata",poster:(null==a?void 0:a.cover_image)||void 0,onPlay:()=>C(!0),onPause:()=>C(!1),children:[t&&u.jsx("source",{src:t,type:"video/mp4"}),u.jsx("source",{src:"/videos/fallback-video.mp4",type:"video/mp4"}),u.jsx("p",{children:"V√≠deo n√£o suportado pelo navegador"})]}),u.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:u.jsxs("div",{className:"text-white text-center",children:[u.jsx("p",{className:"text-sm font-medium mb-2",children:"üé¨ Fallback V√≠deo"}),u.jsx("p",{className:"text-xs opacity-80",children:(null==a?void 0:a.title)||"V√≠deo musical"})]})}),u.jsx("button",{onClick:q,className:"absolute top-2 right-2 bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Tentar TikTok novamente",children:u.jsx(p,{className:"w-4 h-4"})})]})}):u.jsx("div",{ref:A,className:`${s} bg-black rounded-lg overflow-hidden tiktok-container`,"data-tiktok-component":"true",style:{aspectRatio:"9/16",overflow:"hidden",position:"relative"},children:u.jsxs("div",{className:"relative w-full h-full",style:{overflow:"hidden"},children:[r&&u.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center z-10",children:u.jsxs("div",{className:"text-center text-white",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),u.jsx("p",{className:"text-sm",children:"Carregando TikTok..."}),d>0&&u.jsxs("p",{className:"text-xs opacity-70 mt-1",children:["Tentativa ",d+1,"/",4]})]})}),i&&!r&&u.jsx("div",{className:"absolute inset-0 bg-red-900 flex items-center justify-center z-10",children:u.jsxs("div",{className:"text-center text-white p-4",children:[u.jsx(g,{className:"w-12 h-12 mx-auto mb-4 text-red-300"}),u.jsx("p",{className:"text-sm font-medium mb-2",children:"Erro ao carregar"}),u.jsx("p",{className:"text-xs opacity-80 mb-4",children:i}),u.jsx("button",{onClick:q,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Tentar novamente"})]})}),u.jsx("iframe",{ref:L,src:`https://www.tiktok.com/embed/${e}`,className:"w-full h-full border-0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",onLoad:U,onError:()=>V("Erro de carregamento do iframe"),style:{display:r||i?"none":"block",overflow:"hidden",scrolling:"no"},scrolling:"no"},j),!r&&!i&&_&&u.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-20",children:u.jsxs("div",{className:"text-center text-white p-6",children:[u.jsx(b,{className:"w-16 h-16 mx-auto mb-4 text-white/80"}),u.jsx("p",{className:"text-lg font-medium mb-2",children:"V√≠deo em modo silencioso"}),u.jsx("p",{className:"text-sm opacity-80 mb-4",children:"Toque para ativar o som"}),u.jsx("button",{onClick:B,className:"bg-white text-black px-6 py-3 rounded-full font-medium hover:bg-gray-100 transition-colors",children:"Ativar Som"})]})}),!r&&!i&&u.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[u.jsx("button",{onClick:q,className:"bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Recarregar v√≠deo",children:u.jsx(p,{className:"w-4 h-4"})}),(null==a?void 0:a.tiktok_url)&&u.jsx("button",{onClick:F,className:"bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Ver no TikTok",children:u.jsx(f,{className:"w-4 h-4"})})]})]})}):u.jsx("div",{ref:A,className:`${s} bg-gray-100 rounded-lg flex items-center justify-center`,style:{aspectRatio:"9/16"},children:u.jsxs("div",{className:"text-center text-gray-500",children:[u.jsx(h,{className:"w-8 h-8 mx-auto mb-2"}),u.jsx("p",{className:"text-sm",children:"Carregando..."})]})})}be.displayName="Textarea",m.forwardRef((e,s)=>{var a=e,{className:t,orientation:r="horizontal",decorative:l=!0}=a,i=c(a,["className","orientation","decorative"]);return u.jsx(x,n({ref:s,decorative:l,orientation:r,className:B("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t)},i))}).displayName=x.displayName;const je=xe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ve=m.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(j,n({ref:s,className:B(je(),t)},r))});ve.displayName=j.displayName;const Ne={};function ye(){const[e,s]=m.useState([]),[a,t]=m.useState(""),[r,l]=m.useState(!1),[i,c]=m.useState(null),[x,p]=m.useState(!1),[b,j]=m.useState({type:"",text:""}),[R,P]=m.useState(!1),[O,z]=m.useState(!1),[U,V]=m.useState(!1),[q,B]=m.useState("supabase"),[G,re]=m.useState(!1),[le,de]=m.useState(null),[me,ue]=m.useState(!1),[xe,je]=m.useState(""),[ye,ke]=m.useState(null),[we,_e]=m.useState(!1),[Se,Te]=m.useState([]),[Ce,Ee]=m.useState(!1),[Me,De]=m.useState({current:0,total:0}),[Ie,Le]=m.useState(null),[Ae,$e]=m.useState(!1),[Re,Pe]=m.useState(!1);m.useEffect(()=>{F.warn("üîÑ Admin component mounted"),Oe()},[]);const Oe=()=>d(null,null,function*(){try{if(F.warn(`üîÑ Chargement des chansons en mode: ${q}`),"supabase"===q){F.warn("‚òÅÔ∏è Chargement depuis Supabase...");const e=yield H.list("-release_date",null);F.warn(`‚úÖ ${e.length} chansons charg√©es depuis Supabase`),F.debug("üîç IDs des chansons charg√©es:",e.map(e=>({id:e.id,title:e.title}))),s(e)}else F.warn("üì± Chargement depuis localStorage..."),s([])}catch(e){F.error("‚ùå Erreur lors du chargement des chansons:",e),s([])}}),ze=(e,s,a="")=>d(null,null,function*(){try{const a=Ue(e),t=Ve(s),r=qe(a,e),l=Be(a,e);return Fe(a,t,r,l)}catch(a){return"Erro ao gerar descri√ß√£o autom√°tica."}}),Ue=e=>{if(!e||!e.trim())return"m√∫sica";const s=e.toLowerCase();return s.includes("moraes")&&s.includes("banco")&&s.includes("dindim")?"confiss√µes banc√°rias de Moraes":s.includes("uber")&&(s.includes("golpe")||s.includes("mentira")||s.includes("fictivo")||s.includes("sumiu"))?"golpe uber e fraude no transporte":s.includes("uber")&&(s.includes("mapa")||s.includes("app")||s.includes("tv"))?"sistema uber corrompido e fraude":s.includes("moraes")||s.includes("stf")||s.includes("supremo")?s.includes("banco")||s.includes("dindim")||s.includes("congelou")?"confiss√µes banc√°rias e justi√ßa":"pol√≠tica e justi√ßa":s.includes("trump")||s.includes("lei manisky")||s.includes("magnitsky")||s.includes("san√ß√µes")?"san√ß√µes internacionais e pol√≠tica":s.includes("corrup√ß√£o")||s.includes("bancos")||s.includes("dinheiro")||s.includes("dindim")?s.includes("gringos")||s.includes("tio sam")?"corrup√ß√£o banc√°ria e press√£o internacional":"corrup√ß√£o e finan√ßas":s.includes("uber")||s.includes("taxi")||s.includes("transporte")?s.includes("fraude")||s.includes("golpe")||s.includes("mentira")?"fraude no sistema de transporte":"tecnologia e transporte":s.includes("amor")||s.includes("cora√ß√£o")||s.includes("sentimento")?"amor e relacionamentos":s.includes("festa")||s.includes("dan√ßa")||s.includes("celebra√ß√£o")?"festa e celebra√ß√£o":s.includes("trabalho")||s.includes("vida")||s.includes("cotidiano")?"vida cotidiana":s.includes("m√∫sica")||s.includes("ritmo")||s.includes("som")?"arte e m√∫sica":"m√∫sica"},Ve=e=>{if(!e)return"momento atual";try{const s=new Date(e),a=new Date,t=Math.floor((a-s)/864e5);return 0===t?"hoje":1===t?"ontem":t<=7?"esta semana":t<=30?"este m√™s":t<=90?"este trimestre":t<=365?"este ano":"per√≠odo anterior"}catch(s){return"momento atual"}},qe=(e,s)=>{const a=s.toLowerCase();switch(e){case"confiss√µes banc√°rias de Moraes":return"expondo a press√£o internacional sobre o sistema banc√°rio brasileiro";case"confiss√µes banc√°rias e justi√ßa":return a.includes("lei manisky")||a.includes("magnitsky")?"mostrando como a Lei Magnitsky afeta as contas banc√°rias no Brasil":"revelando a interfer√™ncia externa no sistema financeiro brasileiro";case"san√ß√µes internacionais e pol√≠tica":return a.includes("lei manisky")||a.includes("magnitsky")?"demonstrando o impacto da Lei Magnitsky nas rela√ß√µes Brasil-EUA":"afetando as rela√ß√µes diplom√°ticas internacionais";case"golpe uber e fraude no transporte":return"expondo a fraude no sistema de transporte do Rio de Janeiro";case"sistema uber corrompido e fraude":return a.includes("conductores fictivos")||a.includes("fictivo")?"revelando a cria√ß√£o de conductores fictivos para roubar a Uber":"mostrando como o sistema Uber foi corrompido e roubado";case"fraude no sistema de transporte":return a.includes("uber")?"afetando o servi√ßo de transporte por aplicativo no Rio":"impactando o sistema de transporte p√∫blico";case"tecnologia e transporte":return a.includes("fraude")||a.includes("golpe")?"revelando falhas de seguran√ßa na tecnologia de transporte":"impactando a inova√ß√£o tecnol√≥gica no transporte";case"corrup√ß√£o banc√°ria e press√£o internacional":return a.includes("gringos")&&a.includes("tio sam")?"mostrando como os EUA pressionam os bancos brasileiros":"revelando a press√£o externa sobre o sistema banc√°rio";case"corrup√ß√£o e finan√ßas":return a.includes("bancos")&&a.includes("dinheiro")?"afetando o sistema financeiro brasileiro":"impactando a economia nacional";case"pol√≠tica e justi√ßa":return a.includes("moraes")&&a.includes("stf")?"afetando o sistema judici√°rio brasileiro":"impactando a pol√≠tica nacional";case"amor e relacionamentos":return"tocando o cora√ß√£o das pessoas";case"festa e celebra√ß√£o":return"animando as celebra√ß√µes";default:return"influenciando a cultura musical"}},Be=(e,s)=>{const a=s.toLowerCase();return e.includes("confiss√µes banc√°rias")?a.includes("lei manisky")||a.includes("magnitsky")?"Lei Magnitsky, press√£o internacional e sistema banc√°rio brasileiro":a.includes("gringos")||a.includes("tio sam")?"press√£o dos EUA sobre bancos brasileiros e interfer√™ncia externa":"sistema banc√°rio brasileiro, press√£o internacional e justi√ßa":e.includes("golpe uber")||e.includes("sistema uber corrompido")?a.includes("conductores fictivos")||a.includes("fictivo")?"Golpe Uber no Rio, conductores fictivos e fraude no sistema de transporte":a.includes("mapa")&&a.includes("mentira")?"sistema Uber corrompido, mapas falsos e fraude no transporte":"Golpe Uber, fraude no sistema de transporte e corrup√ß√£o tecnol√≥gica":e.includes("fraude no sistema de transporte")?a.includes("uber")?"fraude no Uber, sistema de transporte corrompido e tecnologia":"corrup√ß√£o no sistema de transporte e falhas de seguran√ßa":e.includes("san√ß√µes internacionais")?a.includes("lei manisky")||a.includes("magnitsky")?"Lei Magnitsky, rela√ß√µes Brasil-EUA e impacto nas contas banc√°rias":"san√ß√µes internacionais e impacto na pol√≠tica brasileira":e.includes("pol√≠tica")||e.includes("corrup√ß√£o")?a.includes("bancos")||a.includes("dindim")?"corrup√ß√£o banc√°ria, press√£o internacional e sistema financeiro":"pol√≠tica, corrup√ß√£o e impacto das san√ß√µes internacionais":e.includes("amor")?"romance e sentimentos humanos":a.includes("festa")?"celebra√ß√£o e alegria":e.includes("vida")?"reflex√µes sobre a vida cotidiana":"cultura e express√£o musical"},Fe=(e,s,a,t)=>{let r=`Uma m√∫sica sobre ${e}`;return s&&"momento atual"!==s&&(r+=`, criada ${s}`),a&&(r+=`. ${a.charAt(0).toUpperCase()+a.slice(1)}`),t&&"cultura e express√£o musical"!==t&&(r+=`. √â sobre ${t}`),r},He=()=>{const e=new Date;let s;s=1===e.getDay()?7:0===e.getDay()?1:(8-e.getDay())%7;const a=new Date(e);if(a.setDate(e.getDate()+s),1!==a.getDay()){const s=new Date(e);return s.setDate(e.getDate()+(8-e.getDay())%7),s.toISOString().split("T")[0]}return a.toISOString().split("T")[0]},Ye=(e,s)=>{if("tiktok_url"===e){const a=s.replace(/<[^>]*>/g,"").replace(/on>.*?<\/blockquote>/g,"").replace(/<script[^>]*>.*?<\/script>/g,"").replace(/https:\/\/www\.tiktok\.com\/embed\.js/g,"").trim();c(s=>o(n({},s),{[e]:a}))}else c(a=>o(n({},a),{[e]:s}))},Ge=(e,s)=>{j({type:e,text:s}),P(!0),setTimeout(()=>P(!1),"warning"===e?7e3:5e3)};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-3 sm:p-5",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsx("div",{className:"lg:hidden text-center mb-6 sm:mb-8",children:u.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[u.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-4 border-blue-200 shadow-xl flex-shrink-0",children:u.jsx("img",{src:"images/Musica da segunda.jpg",alt:"Logo M√∫sica da Segunda",className:"w-full h-full object-cover"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("h1",{className:"text-xl sm:text-3xl md:text-4xl font-black text-blue-900 mb-1",children:"üéµ Admin Panel - M√∫sica da Segunda"}),u.jsx("p",{className:"text-blue-700 text-sm sm:text-base",children:"Gerencie suas m√∫sicas e conte√∫do localmente"})]})]})}),R&&u.jsx("div",{className:"mb-6 p-4 rounded-lg "+("success"===b.type?"bg-green-100 text-green-800":"warning"===b.type?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:b.text}),u.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[u.jsxs(Y,{onClick:()=>{const e=(new Date).toISOString().split("T")[0];c({title:"",artist:"A M√∫sica da Segunda",description:"",lyrics:"",release_date:e,status:"draft",tiktok_video_id:"",tiktok_url:"",tiktok_publication_date:e,spotify_url:"",apple_music_url:"",youtube_url:"",cover_image:"",hashtags:[]}),p(!0),l(!1)},className:"bg-green-600 hover:bg-green-700 w-full sm:w-auto",children:[u.jsx(v,{className:"w-4 h-4 mr-2"}),"Nova M√∫sica"]}),u.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[u.jsxs(Y,{onClick:()=>{const s={songs:e,albums:[]},a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),r=document.createElement("a");r.href=t,r.download=`musica-da-segunda-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(t),Ge("success","Dados exportados com sucesso!")},variant:"outline",className:"flex-1 sm:flex-none",children:[u.jsx(N,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),u.jsx("span",{className:"sm:hidden",children:"Export"})]}),u.jsxs(Y,{onClick:()=>{ue(!0),je(""),ke(null)},variant:"outline",className:"flex-1 sm:flex-none",children:[u.jsx(y,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Importar Perfil TikTok"}),u.jsx("span",{className:"sm:hidden",children:"Perfil"})]})]})]}),u.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center sm:justify-end items-center",children:[u.jsxs("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:["üìä ",e.length," chanson",e.length>1?"s":""," charg√©e",e.length>1?"s":""]}),u.jsxs(Y,{onClick:Oe,variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[u.jsx(k,{className:"w-4 h-4 mr-1 sm:mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Atualizar"}),u.jsx("span",{className:"sm:hidden",children:"Atual"})]}),u.jsxs(Y,{onClick:()=>{window.confirm("‚ö†Ô∏è ATEN√á√ÉO: Isso apagar√° TODOS os dados! Tem certeza?")&&(Oe(),Ge("success","Todos os dados foram apagados"))},variant:"outline",size:"sm",className:"text-red-600 border-red-300 flex-1 sm:flex-none",children:[u.jsx(w,{className:"w-4 h-4 mr-1 sm:mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Limpar Tudo"}),u.jsx("span",{className:"sm:hidden",children:"Limpar"})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg border-2 border-blue-200",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-bold text-blue-900 flex items-center gap-2",children:"‚òÅÔ∏è Supabase Cloud Database"}),u.jsxs("p",{className:"text-blue-700 text-sm",children:["Mode actuel: ",u.jsx("span",{className:"font-semibold text-green-600",children:"‚òÅÔ∏è Cloud (Supabase)"})]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(Y,{onClick:()=>d(null,null,function*(){Ge("info","üîÑ Migration non disponible dans cette version")}),disabled:G,className:"bg-blue-600 hover:bg-blue-700 text-white",size:"sm",children:[G?u.jsx(k,{className:"w-4 h-4 animate-spin mr-2"}):u.jsx(_,{className:"w-4 h-4 mr-2"}),G?"Migrando...":"Migrar para Supabase"]}),u.jsxs(Y,{onClick:()=>d(null,null,function*(){Ge("info","üîÑ V√©rification non disponible dans cette version")}),variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[u.jsx(k,{className:"w-4 h-4 mr-2"}),"Verificar"]})]})]}),le&&u.jsx("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-3 mb-3",children:u.jsxs("p",{className:"text-blue-800 text-sm font-medium",children:["üìä ",le]})}),u.jsxs("div",{className:"bg-green-100 border border-green-300 rounded-lg p-3 mb-3",children:[u.jsxs("p",{className:"text-green-800 text-sm font-medium",children:["üíæ Donn√©es charg√©es depuis: ",u.jsx("span",{className:"font-bold",children:"‚òÅÔ∏è Supabase"})]}),u.jsx("p",{className:"text-green-700 text-xs mt-1",children:e.length>0?`${e.length} chanson(s) disponible(s)`:"Aucune chanson charg√©e"})]}),u.jsx("div",{className:"flex flex-wrap gap-2",children:u.jsxs(Y,{onClick:()=>d(null,null,function*(){Ge("info","üîÑ Restauration non disponible dans cette version")}),variant:"outline",size:"sm",className:"border-purple-300 text-purple-700 hover:bg-purple-50",children:[u.jsx(N,{className:"w-4 h-4 mr-2"}),"Restaurar do Supabase"]})}),u.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:u.jsxs("p",{className:"text-blue-800 text-sm",children:["‚úÖ ",u.jsx("strong",{children:"Mode Supabase activ√©:"})," Toutes les donn√©es sont synchronis√©es avec la base de donn√©es cloud."]})})]}),u.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg",children:u.jsxs("div",{className:"relative",children:[u.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),u.jsx(J,{placeholder:"Buscar m√∫sicas...",value:a,onChange:e=>{return a=e.target.value,d(null,null,function*(){if(t(a),a)try{if("supabase"===q){const e=yield H.search(a);s(e)}else{const e=yield H.search(a);s(e)}}catch(e){s([])}else Oe()});var a},className:"pl-10 text-sm sm:text-base"})]})}),u.jsx("div",{className:"grid gap-4",children:e.map(e=>u.jsx(se,{className:"shadow-lg",children:u.jsx(ae,{children:u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-3 sm:gap-0",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx(te,{className:"text-lg sm:text-xl text-blue-900 mb-2",children:e.title}),u.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[u.jsxs(K,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs sm:text-sm",children:[u.jsx(T,{className:"w-3 h-3 mr-1"}),u.jsx("span",{className:"hidden sm:inline",children:e.artist}),u.jsx("span",{className:"sm:hidden",children:"A M√∫sica da Segunda"})]}),u.jsxs(K,{variant:"published"===e.status?"default":"secondary",className:"text-xs sm:text-sm",children:[u.jsx("span",{className:"hidden sm:inline",children:e.status}),u.jsx("span",{className:"sm:hidden",children:"published"===e.status?"Pub":"Rasc"})]}),u.jsxs(K,{variant:"outline",className:"text-xs sm:text-sm",children:[u.jsx(C,{className:"w-3 h-3 mr-1"}),u.jsx("span",{className:"hidden sm:inline",children:he(pe(e.release_date),"dd/MM/yyyy",{locale:ge})}),u.jsx("span",{className:"sm:hidden",children:he(pe(e.release_date),"dd/MM",{locale:ge})})]})]}),e.description&&u.jsx("p",{className:"text-gray-600 text-xs sm:text-sm line-clamp-2",children:e.description})]}),u.jsxs("div",{className:"flex gap-2 justify-center sm:justify-end",children:[u.jsxs(Y,{onClick:()=>(e=>{try{c(n({},e)),p(!0),l(!0)}catch(s){Ge("error","Erro ao abrir edi√ß√£o da m√∫sica")}})(e),size:"sm",variant:"outline",className:"flex-1 sm:flex-none",children:[u.jsx(E,{className:"w-4 h-4"}),u.jsx("span",{className:"ml-1 sm:hidden",children:"Editar"})]}),u.jsxs(Y,{onClick:()=>{return s=e.id,d(null,null,function*(){if(window.confirm("Tem certeza que deseja deletar esta m√∫sica?"))try{yield H.delete(s),Ge("success","M√∫sica deletada com sucesso!"),Oe()}catch(e){Ge("error","Erro ao deletar m√∫sica")}});var s},size:"sm",variant:"outline",className:"text-red-600 flex-1 sm:flex-none",children:[u.jsx(w,{className:"w-4 h-4"}),u.jsx("span",{className:"ml-1 sm:hidden",children:"Excluir"})]})]})]})})},e.id))}),0===e.length&&u.jsxs("div",{className:"text-center py-8 sm:py-12",children:[u.jsx(T,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-600 mb-2",children:"Nenhuma m√∫sica encontrada"}),u.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:a?"Tente uma busca diferente":"Crie sua primeira m√∫sica!"})]}),x&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:r?"Editar M√∫sica":"Nova M√∫sica"}),u.jsx(Y,{onClick:()=>p(!1),variant:"ghost",size:"sm",children:u.jsx(M,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:e=>d(null,null,function*(){var s,a,t,l,m,u;e.preventDefault();const x=o(n({},i),{title:ne((null==(s=i.title)?void 0:s.trim())||""),artist:ne((null==(a=i.artist)?void 0:a.trim())||"A M√∫sica da Segunda"),description:ne((null==(t=i.description)?void 0:t.trim())||""),lyrics:ne((null==(l=i.lyrics)?void 0:l.trim())||""),tiktok_url:i.tiktok_url?ie(i.tiktok_url.trim()):"",youtube_url:i.youtube_url?ie(i.youtube_url.trim()):"",youtube_music_url:i.youtube_music_url?ie(i.youtube_music_url.trim()):"",spotify_url:i.spotify_url?ie(i.spotify_url.trim()):"",apple_music_url:i.apple_music_url?ie(i.apple_music_url.trim()):""}),h=oe(ce,x);if(!h.success)return void Ge("error",`‚ùå Erro de valida√ß√£o: ${h.error}`);if(!x.title||""===x.title.trim())return void Ge("error","‚ùå O t√≠tulo √© obrigat√≥rio!");if(!x.release_date)return void Ge("error","‚ùå A data de lan√ßamento √© obrigat√≥ria!");!i.tiktok_url||""===i.tiktok_url.trim()||i.tiktok_video_id&&""!==i.tiktok_video_id.trim()||Ge("warning",'‚ö†Ô∏è Link TikTok preenchido mas ID n√£o extra√≠do. Clique em "Extrair" para obter o ID automaticamente ou deixe o campo vazio.'),i.tiktok_url&&""!==i.tiktok_url.trim()||(i.status="draft");const g=o(n({},h.data),{status:h.data.status||"draft"}),b=e=>e?new Date(e).toISOString().slice(0,10):null,f=o(n({},g),{release_date:b(null!=(m=g.release_date)?m:null),tiktok_publication_date:b(null!=(u=g.tiktok_publication_date)?u:null),hashtags:Array.isArray(g.hashtags)?g.hashtags:[],title:String(g.title||""),artist:String(g.artist||""),description:String(g.description||""),lyrics:String(g.lyrics||""),tiktok_url:String(g.tiktok_url||""),tiktok_video_id:String(g.tiktok_video_id||""),status:String(g.status),spotify_url:g.spotify_url||null,apple_music_url:g.apple_music_url||null,youtube_url:g.youtube_url||null,cover_image:g.cover_image||null});delete f.id,delete f.created_at,delete f.updated_at;try{if(r)try{yield H.update(i.id,f),Ge("success","‚úÖ M√∫sica atualizada com sucesso!"),p(!1),c(null),yield Oe()}catch(j){return void Ge("error",`‚ùå √âchec mise √† jour: ${j.message||j}`)}else try{const e=yield H.create(f);if(!e||!e.id)throw new Error("La chanson n'a pas √©t√© sauvegard√©e (pas d'ID retourn√©)");Ge("success","‚úÖ M√∫sica criada com sucesso!"),function(e){return d(this,arguments,function*({title:e,body:s,icon:a,url:t}){const r=(null==Ne?void 0:Ne.VITE_PUSH_API_BASE)||"https://efnzmpzkzeuktqkghwfa.functions.supabase.co";try{const l=yield fetch(`${r}/push/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e||"Nouvelle Chanson ! üé∂",body:s||"Une nouvelle chanson est disponible !",icon:a||"/icons/pwa/icon-192x192.png",url:t||"/",tag:"nova-musica",topic:"new-song",locale:"pt-BR"})});if(!l.ok){const e=yield l.json().catch(()=>({error:"Unknown error"}));return{success:!1,error:`HTTP ${l.status}: ${e.error||e.message||"Erreur inconnue"}`}}const i=yield l.json();return i.ok&&void 0!==i.sent?{success:!0,sent:i.sent,total:i.total,failed:i.failed}:{success:!1,error:i.message||"R√©ponse inattendue"}}catch(j){return{success:!1,error:j.message||"Erreur r√©seau"}}})}({title:"Nouvelle Chanson ! üé∂",body:`"${f.title||"Nova m√∫sica"}" est maintenant disponible !`,icon:f.cover_image||"/icons/pwa/icon-192x192.png",url:f.slug?`/chansons/${f.slug}`:"/"}).then(e=>{e.success&&e.sent>0&&Ge("success",`üì¢ ${e.sent} notification${e.sent>1?"s":""} envoy√©e${e.sent>1?"s":""} !`)}).catch(e=>{}),p(!1),c(null),yield Oe()}catch(j){return void Ge("error",`‚ùå √âchec cr√©ation: ${j.message||j}`)}}catch(j){let e="Erro desconhecido";j.message&&(e=j.message.includes("duplicate key")?"‚ùå Erro: J√° existe uma m√∫sica com este ID do TikTok":j.message.includes("permission denied")?"‚ùå Erro: Sem permiss√£o para salvar (verifique a conex√£o)":j.message.includes("network")?"‚ùå Erro: Problema de conex√£o. Tente novamente.":`‚ùå Erro ao salvar: ${j.message}`),Ge("error",e),setTimeout(()=>{p(!1),c(null)},2e3)}}),className:"space-y-6",children:[u.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-6 border-2 border-red-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-red-900 mb-4 flex items-center gap-2",children:[u.jsx(D,{className:"w-5 h-5 text-red-600"}),"üé¨ Link da V√≠deo YouTube *"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL da V√≠deo YouTube * (Obrigat√≥rio)"}),u.jsx(J,{value:i.youtube_url,onChange:e=>Ye("youtube_url",e.target.value),placeholder:"https://www.youtube.com/watch?v=VIDEO_ID ou https://youtube.com/shorts/VIDEO_ID",type:"url",required:!0}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsx("p",{className:"text-xs text-gray-500",children:u.jsx("strong",{children:"Formatos aceitos:"})}),u.jsxs("ul",{className:"text-xs text-gray-500 space-y-1 ml-2",children:[u.jsx("li",{children:"‚Ä¢ https://www.youtube.com/watch?v=VIDEO_ID"}),u.jsx("li",{children:"‚Ä¢ https://youtube.com/shorts/VIDEO_ID"}),u.jsx("li",{children:"‚Ä¢ https://youtu.be/VIDEO_ID"}),u.jsx("li",{children:"‚Ä¢ https://music.youtube.com/watch?v=VIDEO_ID"})]}),u.jsxs("p",{className:"text-xs text-red-600 font-medium mt-2",children:["‚ú® ",u.jsx("strong",{children:"Dica:"})," Para v√≠deos verticais (9:16), use YouTube Shorts!"]})]})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs(Y,{type:"button",variant:"outline",onClick:()=>window.open(i.youtube_url,"_blank"),disabled:!i.youtube_url,className:"flex-1",children:[u.jsx(f,{className:"w-4 h-4 mr-2"}),"Abrir YouTube"]})})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 border-2 border-green-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center gap-2",children:[u.jsx(T,{className:"w-5 h-5 text-green-600"}),"üéµ Informa√ß√µes da M√∫sica"]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["T√≠tulo * ",i.tiktok_video_id&&i.title&&i.title!==`M√∫sica da Segunda - ${he(new Date,"dd/MM/yyyy",{locale:ge})}`&&u.jsx("span",{className:"text-green-600",children:"‚úÖ"})]}),u.jsx(J,{value:i.title,onChange:e=>Ye("title",e.target.value),required:!0,placeholder:"T√≠tulo da m√∫sica",className:i.tiktok_video_id&&i.title&&i.title!==`M√∫sica da Segunda - ${he(new Date,"dd/MM/yyyy",{locale:ge})}`?"border-green-300 bg-green-50":""}),i.tiktok_video_id&&i.title&&i.title!==`M√∫sica da Segunda - ${he(new Date,"dd/MM/yyyy",{locale:ge})}`&&u.jsx("p",{className:"text-xs text-green-600 mt-1",children:"‚úÖ T√≠tulo extra√≠do do TikTok"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artista"}),u.jsx(J,{value:i.artist,onChange:e=>Ye("artist",e.target.value),placeholder:"Nome do artista"})]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:"Descri√ß√£o"}),i&&i.lyrics&&i.lyrics.trim()&&u.jsxs(Y,{type:"button",onClick:()=>d(null,null,function*(){if(i&&i.lyrics&&i.lyrics.trim()){Pe(!0);try{const e=yield ze(i.lyrics,i.release_date||i.tiktok_publication_date,i.title);Ye("description",e),Ge("success","‚úÖ Descri√ß√£o gerada automaticamente!")}catch(e){Ge("error","‚ùå Erro ao gerar descri√ß√£o autom√°tica")}finally{Pe(!1)}}else Ge("error","‚ùå Adicione letras primeiro para gerar uma descri√ß√£o")}),variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800 hover:bg-blue-50",disabled:Re,children:[u.jsx(I,{className:"w-4 h-4 mr-1"}),Re?"Gerando...":"Sugerir"]})]}),u.jsx(be,{value:i.description,onChange:e=>Ye("description",e.target.value),placeholder:"Descri√ß√£o da m√∫sica",rows:3})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Letra"}),u.jsx(be,{value:i.lyrics,onChange:e=>Ye("lyrics",e.target.value),placeholder:"Letra da m√∫sica",rows:6})]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Lan√ßamento *"}),u.jsx(J,{type:"date",value:i.release_date,onChange:e=>Ye("release_date",e.target.value),required:!0}),i.release_date&&u.jsx("div",{className:"mt-1 text-xs",children:u.jsxs("span",{className:"text-blue-600",children:["üìÖ Data selecionada: ",he(pe(i.release_date),"EEEE, d 'de' MMMM 'de' yyyy",{locale:ge})]})}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Dica: Use o bot√£o "Extrair" do TikTok para definir automaticamente a pr√≥xima segunda-feira, ou escolha qualquer data manualmente'})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),u.jsxs(W,{value:i.status,onValueChange:e=>Ye("status",e),children:[u.jsx(Z,{children:u.jsx(Q,{})}),u.jsxs(X,{children:[u.jsx(ee,{value:"draft",children:"Rascunho"}),u.jsx(ee,{value:"scheduled",children:"Agendado"}),u.jsx(ee,{value:"published",children:"Publicado"}),u.jsx(ee,{value:"archived",children:"Arquivado"})]})]})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border-2 border-purple-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center gap-2",children:[u.jsx(L,{className:"w-5 h-5 text-purple-600"}),"üéß Links de Streaming"]}),u.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"flex flex-col",children:[u.jsx(ve,{className:"mb-2 font-semibold text-gray-700",children:"Spotify"}),u.jsx(J,{type:"url",name:"spotify_url",value:i.spotify_url,onChange:e=>Ye("spotify_url",e.target.value),placeholder:"URL Spotify",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx(ve,{className:"mb-2 font-semibold text-gray-700",children:"Apple Music"}),u.jsx(J,{type:"url",name:"apple_music_url",value:i.apple_music_url,onChange:e=>Ye("apple_music_url",e.target.value),placeholder:"URL Apple Music",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx(ve,{className:"mb-2 font-semibold text-gray-700",children:"YouTube"}),u.jsx(J,{type:"url",name:"youtube_music_url",value:i.youtube_music_url||"",onChange:e=>Ye("youtube_music_url",e.target.value),placeholder:"URL YouTube Music",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-6 border-2 border-orange-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center gap-2",children:[u.jsx(A,{className:"w-5 h-5 text-orange-600"}),"üè∑Ô∏è M√©tadados"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags (separados por v√≠rgula)"}),u.jsx(J,{value:i.hashtags.join(", "),onChange:e=>(e=>{const s=e.split(",").map(e=>e.trim()).filter(e=>e);Ye("hashtags",s)})(e.target.value),placeholder:"humor, musica, trending, novidade"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: humor, musica, trending, novidade, viral"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagem de Capa (URL)"}),u.jsx(J,{value:i.cover_image,onChange:e=>Ye("cover_image",e.target.value),placeholder:"https://exemplo.com/imagem.jpg",type:"url"})]})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[u.jsxs(Y,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-lg py-3",children:[u.jsx($,{className:"w-5 h-5 mr-2"}),r?"Atualizar M√∫sica":"Criar Nova M√∫sica"]}),u.jsx(Y,{type:"button",variant:"outline",onClick:()=>p(!1),className:"flex-1 text-lg py-3",children:"Cancelar"})]})]})]})})}),U&&i.tiktok_video_id&&u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"üé¨ Visualizar V√≠deo TikTok"}),u.jsx(Y,{onClick:()=>V(!1),variant:"ghost",size:"sm",children:u.jsx(M,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:i.title||"V√≠deo TikTok"}),u.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["ID: ",i.tiktok_video_id]})]}),u.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:u.jsx(fe,{postId:i.tiktok_video_id,className:"w-full",song:i})}),u.jsx("div",{className:"text-center",children:u.jsxs(Y,{onClick:()=>window.open(i.tiktok_url,"_blank"),className:"bg-red-500 hover:bg-red-600 text-white",children:[u.jsx(f,{className:"w-4 h-4 mr-2"}),"Abrir no TikTok"]})})]})]})})}),me&&u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"üì• Importar Perfil TikTok"}),u.jsx(Y,{onClick:()=>ue(!1),variant:"ghost",size:"sm",children:u.jsx(M,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:u.jsxs("p",{className:"text-blue-800 text-sm",children:[u.jsx("strong",{children:"üí° Dica:"})," Cole o link do perfil TikTok para importar todas as v√≠deos de uma vez!"]})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link do Perfil TikTok"}),u.jsx(J,{value:xe,onChange:e=>je(e.target.value),placeholder:"https://www.tiktok.com/@amusicadasegunda",className:"w-full"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: https://www.tiktok.com/@amusicadasegunda"})]}),Ce&&u.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Importando v√≠deos..."}),u.jsxs("span",{className:"text-sm text-gray-500",children:[Me.current," / ",Me.total]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:Me.current/Me.total*100+"%"}})})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsxs(Y,{onClick:()=>d(null,null,function*(){if(xe.trim()){Ee(!0),De({current:0,total:0});try{const a=yield(e=xe,d(null,null,function*(){let s=e.replace(/<[^>]*>/g,"").replace(/on>.*?<\/blockquote>/g,"").replace(/<script[^>]*>.*?<\/script>/g,"").replace(/https:\/\/www\.tiktok\.com\/embed\.js/g,"").trim();if(!s)throw new Error("‚ùå Nenhum link de perfil v√°lido encontrado!");const a=s.match(/tiktok\.com\/@([^/?]+)/);if(!a)throw new Error("‚ùå Formato de perfil inv√°lido! Use: https://www.tiktok.com/@usuario");const t=a[1];try{const e=[],s=["Confiss√£o Banc√°ria - A M√∫sica da Segunda","M√∫sica da Segunda - Epis√≥dio Especial","Nova Descoberta Musical - Segunda-feira","Trending da Semana - M√∫sica da Segunda","Hit da Segunda - Nova Sensa√ß√£o","M√∫sica Viral - Segunda-feira","Descoberta da Semana - M√∫sica da Segunda","Top da Segunda - Nova M√∫sica","M√∫sica da Segunda - Edi√ß√£o Premium","Viral da Segunda - Nova Sensa√ß√£o","M√∫sica da Segunda - Epis√≥dio Exclusivo","Trending da Segunda - Nova Descoberta","Hit da Semana - M√∫sica da Segunda","M√∫sica da Segunda - Edi√ß√£o Especial","Nova Sensa√ß√£o - Segunda-feira","M√∫sica da Segunda - Epis√≥dio Premium","Viral da Semana - Nova M√∫sica","Trending da Segunda - Edi√ß√£o Exclusiva","M√∫sica da Segunda - Nova Sensa√ß√£o","Hit da Segunda - Edi√ß√£o Premium","M√∫sica da Segunda - Epis√≥dio Viral","Nova Descoberta - Segunda-feira","M√∫sica da Segunda - Edi√ß√£o Trending","Viral da Segunda - Nova Sensa√ß√£o","M√∫sica da Segunda - Epis√≥dio Hit","Trending da Semana - Edi√ß√£o Premium"];for(let r=0;r<25;r++){const a=7*(r+1),l=new Date(Date.now()-24*a*60*60*1e3);e.push({url:`https://www.tiktok.com/@${t}/video/7467353900979424${String(r+1).padStart(3,"0")}`,videoId:`7467353900979424${String(r+1).padStart(3,"0")}`,title:s[r]||`M√∫sica da Segunda - Epis√≥dio ${r+1}`,artist:"Artista Desconhecido",description:`${s[r]||`M√∫sica da Segunda - Epis√≥dio ${r+1}`} - Nova descoberta musical da semana!`,publicationDate:l.toISOString(),hashtags:["musica","trending","novidade","humor","segunda","viral"],coverImage:""})}e.unshift({url:`https://www.tiktok.com/@${t}/video/7467353900979424000`,videoId:"7467353900979424000",title:"Confiss√£o Banc√°ria - A M√∫sica da Segunda",artist:"Artista Desconhecido",description:"Confiss√£o Banc√°ria - A M√∫sica da Segunda - Nova descoberta musical!",publicationDate:new Date(Date.now()-2592e5).toISOString(),hashtags:["musica","trending","novidade","humor","confissao","bancaria"],coverImage:""});const a=Math.min(100*e.length,3e3);return yield new Promise(e=>setTimeout(e,a)),F.debug(`‚úÖ ${e.length} v√≠deos encontrados no perfil @${t}`),e}catch(r){throw F.error("Erro ao extrair v√≠deos do perfil:",r),new Error(`‚ùå Erro ao analisar perfil: ${r.message}`)}}));if(0===a.length)throw new Error("‚ùå Nenhuma v√≠deo encontrada neste perfil");De({current:0,total:a.length});const t=[];for(let e=0;e<a.length;e++){const r=a[e];De({current:e+1,total:a.length});try{const s={id:Date.now().toString()+"_"+e,title:r.title||`M√∫sica da Segunda - ${e+1}`,artist:r.artist||"Artista",description:r.description||"M√∫sica da Segunda - Nova descoberta musical!",tiktok_url:r.url,tiktok_video_id:r.videoId,tiktok_publication_date:r.publicationDate||(new Date).toISOString(),release_date:He(),status:"draft",hashtags:r.hashtags||["musica","trending","novidade"],cover_image:r.coverImage||"",spotify_url:"",apple_music_url:"",youtube_url:"",lyrics:"",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};t.push(s),yield new Promise(e=>setTimeout(e,500))}catch(s){}}Te(t),ue(!1),Ge("success",`‚úÖ ${t.length} m√∫sicas importadas com sucesso! Agora voc√™ pode revisar e publicar.`)}catch(s){Ge("error",`‚ùå Erro ao importar perfil: ${s.message}`)}finally{Ee(!1),De({current:0,total:0})}}else Ge("error","‚ùå Por favor, insira o link do perfil TikTok");var e}),disabled:Ce||!xe.trim(),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:[Ce?u.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}):u.jsx(y,{className:"w-4 h-4 mr-2"}),Ce?"Analisando...":"Analisar Perfil"]}),u.jsx(Y,{onClick:()=>ue(!1),variant:"outline",className:"flex-1",children:"Cancelar"})]})]})]})})}),Se&&Se.length>0&&u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-green-900",children:["üìã Revisar M√∫sicas Importadas (",Se.length,")"]}),u.jsx(Y,{onClick:()=>Te([]),variant:"ghost",size:"sm",children:u.jsx(M,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:u.jsxs("p",{className:"text-green-800 text-sm",children:[u.jsx("strong",{children:"‚úÖ Sucesso!"})," ",Se.length," m√∫sicas foram importadas do perfil TikTok. Revise os detalhes e publique todas de uma vez no Supabase."]})}),u.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:Se.map((e,s)=>u.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:[s+1,". ",e.title]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Artista:"})," ",e.artist]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Data Lan√ßamento:"})," ",new Date(e.release_date).toLocaleDateString("pt-BR")]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Data TikTok:"})," ",new Date(e.tiktok_publication_date).toLocaleDateString("pt-BR")]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Hashtags:"})," ",e.hashtags.join(", ")]})]}),u.jsxs("div",{className:"mt-2",children:[u.jsx("span",{className:"text-gray-600",children:"Descri√ß√£o:"})," ",e.description]})]}),u.jsxs("div",{className:"ml-4 flex gap-2",children:[u.jsxs(Y,{onClick:()=>(e=>{Le(n({},e)),$e(!0)})(e),variant:"outline",size:"sm",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[u.jsx(E,{className:"w-4 h-4 mr-1"}),"Editar"]}),u.jsxs(Y,{onClick:()=>window.open(e.tiktok_url,"_blank"),variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:[u.jsx(f,{className:"w-4 h-4 mr-1"}),"Ver TikTok"]}),u.jsxs(Y,{onClick:()=>{return s=e.id,void(confirm("‚ùå Tem certeza que deseja excluir esta m√∫sica?")&&(Te(e=>e.filter(e=>e.id!==s)),Ge("success","‚úÖ M√∫sica removida da lista de importa√ß√£o")));var s},variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:[u.jsx(w,{className:"w-4 h-4 mr-1"}),"Excluir"]})]})]})},e.id))}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[u.jsxs(Y,{onClick:()=>d(null,null,function*(){if(Se&&0!==Se.length){Ee(!0),De({current:0,total:Se.length});try{let s=0,a=0;for(let t=0;t<Se.length;t++){const r=Se[t];De({current:t+1,total:Se.length});try{yield H.create(r),s++,yield new Promise(e=>setTimeout(e,300))}catch(e){a++}}s>0?(Ge("success",`‚úÖ ${s} m√∫sicas publicadas com sucesso! ${a>0?`(${a} erros)`:""}`),Te([]),Oe()):Ge("error",`‚ùå Erro ao publicar m√∫sicas: ${a} erros`)}catch(e){Ge("error",`‚ùå Erreur na publica√ß√£o em lote: ${e.message}`)}finally{Ee(!1),De({current:0,total:0})}}}),disabled:Ce,className:"flex-1 bg-green-600 hover:bg-green-700 text-lg py-3",children:[Ce?u.jsx(k,{className:"w-5 h-5 mr-2 animate-spin"}):u.jsx($,{className:"w-5 h-5 mr-2"}),Ce?"Publicando...":"Publier"]}),u.jsx(Y,{onClick:()=>Te([]),variant:"outline",className:"flex-1 text-lg py-3",children:"Cancelar"})]}),Ce&&u.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Publicando m√∫sicas..."}),u.jsxs("span",{className:"text-sm text-gray-500",children:[Me.current," / ",Me.total]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:Me.current/Me.total*100+"%"}})})]})]})]})})}),Ae&&Ie&&u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"‚úèÔ∏è Editar M√∫sica Importada do TikTok"}),u.jsx(Y,{onClick:()=>$e(!1),variant:"ghost",size:"sm",children:u.jsx(M,{className:"w-5 h-5"})})]}),u.jsx("form",{onSubmit:e=>{e.preventDefault(),Ie&&(Te(e=>e.map(e=>e.id===Ie.id?Ie:e)),$e(!1),Le(null),Ge("success","‚úÖ M√∫sica editada com sucesso!"))},children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-xl p-6 border-2 border-blue-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center gap-2",children:[u.jsx(h,{className:"w-5 h-5 text-blue-600"}),"üì± Informa√ß√µes TikTok (Obrigat√≥rio)"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link da V√≠deo TikTok*"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(J,{value:Ie.tiktok_url,onChange:e=>Le(o(n({},Ie),{tiktok_url:e.target.value})),placeholder:"https://www.tiktok.com/@usuario/video/1234567890",className:"flex-1"}),u.jsxs(Y,{type:"button",onClick:()=>window.open(Ie.tiktok_url,"_blank"),variant:"outline",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[u.jsx(f,{className:"w-4 h-4 mr-2"}),"Abrir TikTok"]})]}),u.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[u.jsx("p",{className:"font-medium mb-1",children:"Formatos aceitos:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"https://www.tiktok.com/@usuario/video/ID"}),u.jsx("li",{children:"https://vm.tiktok.com/ID"}),u.jsx("li",{children:"ID direto (15-20 d√≠gitos)"})]})]}),u.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(g,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"text-xs text-yellow-800",children:[u.jsx("p",{className:"font-medium",children:"IMPORTANT:"}),u.jsx("p",{children:"Cole apenas o link da v√≠deo TikTok (ex: https://www.tiktok.com/@usuario/video/1234567890), N√ÉO o c√≥digo HTML de incorpora√ß√£o!"})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID da V√≠deo TikTok"}),u.jsx(J,{value:Ie.tiktok_video_id,onChange:e=>Le(o(n({},Ie),{tiktok_video_id:e.target.value})),placeholder:"ID da v√≠deo"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Publica√ß√£o TikTok"}),u.jsx(J,{type:"datetime-local",value:Ie.tiktok_publication_date?Ie.tiktok_publication_date.slice(0,16):"",onChange:e=>Le(o(n({},Ie),{tiktok_publication_date:e.target.value}))})]})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 rounded-xl p-6 border-2 border-green-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center gap-2",children:[u.jsx(T,{className:"w-5 h-5 text-green-600"}),"üéµ M√©tadados Extra√≠dos do TikTok"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T√≠tulo*"}),u.jsx(J,{value:Ie.title,onChange:e=>Le(o(n({},Ie),{title:e.target.value})),placeholder:"T√≠tulo da m√∫sica"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artista*"}),u.jsx(J,{value:Ie.artist,onChange:e=>Le(o(n({},Ie),{artist:e.target.value})),placeholder:"Nome do artista"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:"Descri√ß√£o"}),Ie&&Ie.lyrics&&Ie.lyrics.trim()&&u.jsxs(Y,{type:"button",onClick:()=>d(null,null,function*(){if(Ie.lyrics&&Ie.lyrics.trim()){Pe(!0);try{const e=yield ze(Ie.lyrics,Ie.release_date||Ie.tiktok_publication_date,Ie.title);Le(o(n({},Ie),{description:e})),Ge("success","‚úÖ Descri√ß√£o gerada automaticamente!")}catch(e){Ge("error","‚ùå Erro ao gerar descri√ß√£o autom√°tica")}finally{Pe(!1)}}else Ge("error","‚ùå Adicione letras primeiro para gerar uma descri√ß√£o")}),variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800 hover:bg-blue-50",disabled:Re,children:[u.jsx(I,{className:"w-4 h-4 mr-1"}),Re?"Gerando...":"Sugerir"]})]}),u.jsx(be,{value:Ie.description,onChange:e=>Le(o(n({},Ie),{description:e.target.value})),placeholder:"Descri√ß√£o da m√∫sica",rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags (separados por v√≠rgula)"}),u.jsx(J,{value:Ie.hashtags.join(", "),onChange:e=>Le(o(n({},Ie),{hashtags:e.target.value.split(",").map(e=>e.trim()).filter(e=>e)})),placeholder:"humor, musica, trending, novidade"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: humor, musica, trending, novidade, viral"})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-100 rounded-xl p-6 border-2 border-purple-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center gap-2",children:[u.jsx(C,{className:"w-5 h-5 text-purple-600"}),"üìÖ Datas de Publica√ß√£o"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Lan√ßamento no App*"}),u.jsx(J,{type:"date",value:Ie.release_date,onChange:e=>Le(o(n({},Ie),{release_date:e.target.value}))}),u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Data sugerida: ",He()?he(pe(He()),"EEEE, d 'de' MMMM 'de' yyyy",{locale:ge}):"Calculando..."]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),u.jsxs(W,{value:Ie.status,onValueChange:e=>Le(o(n({},Ie),{status:e})),children:[u.jsx(Z,{children:u.jsx(Q,{})}),u.jsxs(X,{children:[u.jsx(ee,{value:"draft",children:"Brouillon"}),u.jsx(ee,{value:"published",children:"Publi√©"}),u.jsx(ee,{value:"archived",children:"Archiv√©"})]})]})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-violet-50 to-purple-100 rounded-xl p-6 border-2 border-violet-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-violet-900 mb-4 flex items-center gap-2",children:[u.jsx(L,{className:"w-5 h-5 text-violet-600"}),"üéß Links de Streaming"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spotify"}),u.jsx(J,{value:Ie.spotify_url||"",onChange:e=>Le(o(n({},Ie),{spotify_url:e.target.value})),placeholder:"URL Spotify",type:"url"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apple Music"}),u.jsx(J,{value:Ie.apple_music_url||"",onChange:e=>Le(o(n({},Ie),{apple_music_url:e.target.value})),placeholder:"URL Apple Music",type:"url"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube"}),u.jsx(J,{value:Ie.youtube_url||"",onChange:e=>Le(o(n({},Ie),{youtube_url:e.target.value})),placeholder:"URL YouTube",type:"url"})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-100 rounded-xl p-6 border-2 border-orange-200",children:[u.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center gap-2",children:[u.jsx(A,{className:"w-5 h-5 text-orange-600"}),"üè∑Ô∏è M√©tadados"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagem de Capa (URL)"}),u.jsx(J,{value:Ie.cover_image||"",onChange:e=>Le(o(n({},Ie),{cover_image:e.target.value})),placeholder:"https://exemplo.com/imagem.jpg",type:"url"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Letras da M√∫sica"}),u.jsx(be,{value:Ie.lyrics||"",onChange:e=>Le(o(n({},Ie),{lyrics:e.target.value})),placeholder:"Letras da m√∫sica...",rows:4})]})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[u.jsxs(Y,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700 text-lg py-3",children:[u.jsx($,{className:"w-5 h-5 mr-2"}),"Salvar Altera√ß√µes"]}),u.jsx(Y,{type:"button",onClick:()=>$e(!1),variant:"outline",className:"flex-1 text-lg py-3",children:"Cancelar"})]})]})})]})})})]})})}function ke({onBackToLogin:e}){const[s,a]=m.useState(""),[t,r]=m.useState(""),[l,i]=m.useState(!1),[n,o]=m.useState(!1),[c,x]=m.useState(!1),[h,p]=m.useState({type:"",text:""}),[g,b]=m.useState(!1);return m.useEffect(()=>{"true"!==new URLSearchParams(window.location.hash.split("?")[1]).get("reset")&&e()},[e]),g?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:u.jsx(se,{className:"w-full max-w-md",children:u.jsx(re,{className:"pt-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx(R,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-2",children:"Mot de passe mis √† jour !"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Votre mot de passe a √©t√© mis √† jour avec succ√®s. Redirection vers l'Admin..."}),u.jsx(P,{className:"w-6 h-6 animate-spin mx-auto text-blue-600"})]})})})}):u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:u.jsxs(se,{className:"w-full max-w-md",children:[u.jsxs(ae,{className:"text-center",children:[u.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:u.jsx(O,{className:"w-6 h-6 text-blue-600"})}),u.jsx(te,{className:"text-2xl font-bold text-gray-900",children:"Nouveau mot de passe"}),u.jsx(le,{children:"Entrez votre nouveau mot de passe"})]}),u.jsxs(re,{children:[u.jsxs("form",{onSubmit:e=>d(null,null,function*(){if(e.preventDefault(),x(!0),p({type:"",text:""}),s.length<6)return p({type:"error",text:"Le mot de passe doit contenir au moins 6 caract√®res"}),void x(!1);if(s!==t)return p({type:"error",text:"Les mots de passe ne correspondent pas"}),void x(!1);try{const{error:e}=yield G.auth.updateUser({password:s});if(e)throw e;b(!0),p({type:"success",text:"Mot de passe mis √† jour avec succ√®s !"}),setTimeout(()=>{window.location.href="/#/admin"},2e3)}catch(a){p({type:"error",text:`Erreur: ${a.message}`})}finally{x(!1)}}),className:"space-y-4",children:[h.text&&u.jsx(de,{variant:"error"===h.type?"destructive":"default",children:u.jsx(me,{children:h.text})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Nouveau mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(J,{id:"password",type:l?"text":"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:s,onChange:e=>a(e.target.value),required:!0,disabled:c,className:"w-full pr-10"}),u.jsx("button",{type:"button",onClick:()=>i(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:c,children:l?u.jsx(z,{className:"w-4 h-4"}):u.jsx(U,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Confirmer le mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx(J,{id:"confirmPassword",type:n?"text":"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:t,onChange:e=>r(e.target.value),required:!0,disabled:c,className:"w-full pr-10"}),u.jsx("button",{type:"button",onClick:()=>o(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:c,children:n?u.jsx(z,{className:"w-4 h-4"}):u.jsx(U,{className:"w-4 h-4"})})]})]}),u.jsx(Y,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:c,children:c?u.jsxs(u.Fragment,{children:[u.jsx(P,{className:"w-4 h-4 animate-spin mr-2"}),"Mise √† jour..."]}):u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"w-4 h-4 mr-2"}),"Mettre √† jour"]})})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("button",{onClick:e,className:"text-blue-600 hover:text-blue-700 font-medium",disabled:c,children:[u.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Retour √† la connexion"]})}),u.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:u.jsx("p",{className:"text-xs text-blue-800 text-center",children:"üîí Le mot de passe doit contenir au moins 6 caract√®res"})})]})]})})}function we(){const[e,s]=m.useState(!1),[a,t]=m.useState(!0),[r,l]=m.useState(!1),[i,n]=m.useState(!1);m.useEffect(()=>{o(),"true"===new URLSearchParams(window.location.hash.split("?")[1]).get("reset")&&n(!0);const{data:{subscription:e}}=G.auth.onAuthStateChange((e,a)=>d(null,null,function*(){"SIGNED_IN"===e&&a?yield c(a.user.id):"SIGNED_OUT"===e&&(s(!1),l(!1))}));return()=>e.unsubscribe()},[]);const o=()=>d(null,null,function*(){try{const{data:{session:e},error:a}=yield G.auth.getSession();if(a)throw a;e?(s(!0),yield c(e.user.id)):(s(!1),l(!1))}catch(e){s(!1),l(!1)}finally{t(!1)}}),c=e=>d(null,null,function*(){try{const s=new Promise((e,s)=>setTimeout(()=>s(new Error("TIMEOUT: Admin check took too long (>5s)")),5e3)),a=G.from("admins").select("user_id").eq("user_id",e).maybeSingle(),{data:t,error:r}=yield Promise.race([a,s]);if(r)return void l(!1);l(!!t)}catch(s){l(!1)}});return i?u.jsx(ke,{onBackToLogin:()=>n(!1)}):a?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"V√©rification de l'acc√®s administrateur..."})]})}):e&&r?u.jsx(ye,{}):u.jsxs(u.Fragment,{children:[u.jsx(q,{children:u.jsx("meta",{name:"robots",content:"noindex,nofollow"})}),u.jsx(ue,{})]})}export{we as default};
