import{r as a,j as t,L as Z}from"./vendor-react-CM84WoKi.js";import{u as ee,S as te,t as se,e as Y,L as le,j as ae}from"./index-DONdmDIg.js";import{u as re,Y as A,P as oe,n as ne,F as ie}from"./vendor-ui-8p2QWU2G.js";import"./vendor-supabase-ci4wIQv9.js";import"./vendor-date-HUzpq8ep.js";const P=[{label:"Jan",full:"Janeiro",index:0,color:"#3B82F6"},{label:"Fev",full:"Fevereiro",index:1,color:"#6366F1"},{label:"Mar",full:"Mar√ßo",index:2,color:"#EC4899"},{label:"Abr",full:"Abril",index:3,color:"#F97316"},{label:"Mai",full:"Maio",index:4,color:"#10B981"},{label:"Jun",full:"Junho",index:5,color:"#EAB308"},{label:"Jul",full:"Julho",index:6,color:"#F59E0B"},{label:"Ago",full:"Agosto",index:7,color:"#EF4444"},{label:"Set",full:"Setembro",index:8,color:"#8B5CF6"},{label:"Out",full:"Outubro",index:9,color:"#14B8A6"},{label:"Nov",full:"Novembro",index:10,color:"#06B6D4"},{label:"Dez",full:"Dezembro",index:11,color:"#F43F5E"}];function g(o){if(!o)return null;const w=/^\d{4}-\d{2}-\d{2}$/.test(o)?o+"T12:00:00":o,i=new Date(w);return isNaN(i.getTime())?null:i}function j(o){return(o||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function pe(){ee({title:"Pesquisar m√∫sicas - A M√∫sica da Segunda",description:"Encontre qualquer m√∫sica do projeto A M√∫sica da Segunda.",url:"/search",type:"website",robots:"noindex, follow"});const[o,w]=a.useState([]),[i,B]=a.useState(!0),[h,$]=a.useState(""),[x,k]=a.useState(new Set),[m,z]=a.useState(new Set),[I,O]=a.useState(new Set),[p,q]=a.useState(null),[J,C]=a.useState(!1),[R,_]=a.useState(!1),M=a.useRef(null),D=a.useRef(null),[L,V]=a.useState(null),[d,H]=a.useState(null),[F,b]=a.useState("stopped");a.useEffect(()=>{te.list("-release_date").then(e=>{const l=e||[];w(l);const s=new Set;l.forEach(c=>{const r=g(c.release_date);r&&s.add(r.getFullYear())}),k(s),B(!1)})},[]);const E=a.useMemo(()=>{const e=new Set;return o.forEach(l=>{const s=g(l.release_date);s&&e.add(s.getFullYear())}),[...e].sort((l,s)=>s-l)},[o]),u=a.useMemo(()=>{const e=j(h.trim()),l=e.length>0,s=x.size>0,c=m.size>0;return!l&&!s&&!c?[]:o.filter(r=>{const n=g(r.release_date),T=!l||j(r.title).includes(e)||j(r.artist).includes(e)||j(r.description).includes(e)||n&&String(n.getFullYear()).includes(e),f=!s||n&&x.has(n.getFullYear()),y=!c||n&&m.has(n.getMonth());return T&&f&&y})},[h,x,m,o]),N=h.trim().length>0||x.size>0||m.size>0,W=e=>{k(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},Q=e=>{z(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},G=e=>{O(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},v=e=>{M.current?.contentWindow?.postMessage(JSON.stringify({event:"command",func:e,args:[]}),"*")},S=()=>{d&&(v("playVideo"),b("playing"))},K=e=>{const l=Y(e.youtube_url);l&&(L===e.id?F==="playing"?(v("pauseVideo"),b("paused")):(v("playVideo"),b("playing")):(V(e.id),H(l),b("paused")))};a.useEffect(()=>{if(!d)return;const e=setTimeout(()=>S(),250),l=setTimeout(()=>S(),900);return D.current=l,()=>{clearTimeout(e),clearTimeout(l),D.current=null}},[d]);const U=e=>{q(e),window.innerWidth<1024?_(!0):C(!0)};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-sky-50 via-white to-blue-50",children:[d&&t.jsx("iframe",{ref:M,src:`https://www.youtube-nocookie.com/embed/${d}?enablejsapi=1&autoplay=1&rel=0`,title:"player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",onLoad:S,style:{position:"fixed",top:"-9999px",left:"-9999px",width:"1px",height:"1px",opacity:0,pointerEvents:"none"}},d),t.jsxs("div",{className:"text-center pt-6 pb-4 px-4",children:[t.jsx("h1",{className:"text-3xl font-black text-gray-800 tracking-tight",children:"Pesquisar"}),t.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Encontre uma m√∫sica do projeto"})]}),t.jsxs("div",{className:"max-w-2xl mx-auto px-4 pb-24",children:[t.jsxs("div",{className:"relative mb-5",children:[t.jsx(re,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"}),t.jsx("input",{type:"search",autoFocus:!0,value:h,onChange:e=>$(e.target.value),placeholder:"Pesquisar m√∫sica, artista, ano...",className:"w-full pl-12 pr-4 py-4 rounded-2xl border border-gray-200 bg-white shadow-sm text-gray-800 text-base focus:outline-none focus:ring-2 focus:ring-[#32a2dc]/40 focus:border-[#32a2dc] transition-all"})]}),E.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"Ano"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(e=>{const l=x.has(e);return t.jsx("button",{onClick:()=>W(e),className:"px-4 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:l?{backgroundColor:"#1a1a2e",borderColor:"#1a1a2e",color:"#fff"}:{backgroundColor:"#fff",borderColor:"#1a1a2e33",color:"#1a1a2e"},children:e},e)})})]}),t.jsxs("div",{className:"mb-5",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"M√™s"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(e=>{const l=m.has(e.index);return t.jsx("button",{onClick:()=>Q(e.index),title:e.full,className:"px-3 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:l?{backgroundColor:e.color,borderColor:e.color,color:"#fff"}:{backgroundColor:"#fff",borderColor:e.color+"55",color:e.color},children:e.label},e.index)})})]}),N&&!i&&t.jsx("p",{className:"text-xs text-gray-400 mb-4 px-1",children:u.length===0?"Nenhuma m√∫sica encontrada":`${u.length} m√∫sica${u.length>1?"s":""} encontrada${u.length>1?"s":""}`}),i&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[#32a2dc] border-t-transparent rounded-full animate-spin"})}),!i&&!N&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-300",children:[t.jsx(A,{className:"w-16 h-16 mb-4"}),t.jsx("p",{className:"text-base font-medium text-center",children:"Digite uma palavra ou escolha um m√™s"})]}),!i&&N&&u.length>0&&t.jsx("div",{className:"space-y-3",children:u.map(e=>{const l=se(e.title),s=g(e.release_date),c=s?s.getMonth():null,r=c!==null?P[c].color:"#32a2dc",n=Y(e.youtube_url),f=L===e.id&&F==="playing",y=I.has(e.id),X=(e.description||"").trim().length>160;return t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"h-1 w-full",style:{backgroundColor:r}}),t.jsxs("div",{className:"px-5 py-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:r+"18"},children:t.jsx(A,{className:"w-4 h-4",style:{color:r}})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"min-w-0 flex-1",children:l?t.jsx(Z,{to:`/musica/${l}/`,className:"text-base font-black text-gray-800 hover:text-[#32a2dc] transition-colors leading-tight block truncate",children:e.title}):t.jsx("p",{className:"text-base font-black text-gray-800 leading-tight truncate",children:e.title})}),n&&t.jsx("button",{onClick:()=>K(e),className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110 shadow-sm",style:{backgroundColor:f?r:r+"22"},"aria-label":f?"Pausar":"Tocar",children:f?t.jsx(oe,{className:"w-3.5 h-3.5 text-white"}):t.jsx(ne,{className:"w-3.5 h-3.5 ml-0.5",style:{color:r}})})]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[e.artist,s&&t.jsxs("span",{className:"text-gray-400 ml-2",children:["¬∑ ",s.toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"})]})]})]})]}),e.description&&t.jsxs("div",{className:"pl-12 mt-2",children:[t.jsx("p",{className:`text-sm text-gray-600 leading-relaxed ${y?"":"line-clamp-3"}`,children:e.description}),X&&t.jsx("button",{type:"button",onClick:()=>G(e.id),className:"mt-1.5 text-xs font-semibold text-[#32a2dc] hover:text-[#2589b8] underline underline-offset-2",children:y?"Ver menos":"Ler mais"})]}),(e.spotify_url||e.youtube_music_url||e.apple_music_url||e.lyrics)&&t.jsx("div",{className:"mt-3 pl-12",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:flex-wrap",children:[e.spotify_url&&t.jsx("a",{href:e.spotify_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex w-full items-center justify-center gap-1.5 px-3 py-1.5 rounded-xl bg-[#1DB954]/10 text-[#1DB954] text-xs font-bold hover:bg-[#1DB954]/20 transition-colors sm:w-auto sm:justify-start",children:"üéß Spotify"}),e.apple_music_url&&t.jsx("a",{href:e.apple_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex w-full items-center justify-center gap-1.5 px-3 py-1.5 rounded-xl bg-pink-50 text-pink-600 text-xs font-bold hover:bg-pink-100 transition-colors sm:w-auto sm:justify-start",children:"üéµ Apple Music"}),e.youtube_music_url&&t.jsx("a",{href:e.youtube_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex w-full items-center justify-center gap-1.5 px-3 py-1.5 rounded-xl bg-red-50 text-red-600 text-xs font-bold hover:bg-red-100 transition-colors sm:w-auto sm:justify-start",children:"üì± Video"}),t.jsxs("button",{type:"button",onClick:()=>U(e),disabled:!e.lyrics||!e.lyrics.trim(),className:`inline-flex w-full items-center justify-center gap-1.5 px-3 py-1.5 rounded-xl text-xs font-bold transition-colors sm:w-auto sm:justify-start ${e.lyrics&&e.lyrics.trim()?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-slate-50 text-slate-400 cursor-not-allowed"}`,"aria-label":e.lyrics&&e.lyrics.trim()?"Ver letras":"Letras indispon√≠veis",children:[t.jsx(ie,{className:"w-3.5 h-3.5"}),"Letras"]})]})})]})]},e.id)})}),t.jsx(le,{open:J,onOpenChange:C,song:p,title:p?`Letras - ${p.title}`:"Letras da M√∫sica",maxHeight:"h-[55vh]"}),t.jsx(ae,{open:R,onOpenChange:_,lyrics:p?.lyrics,songTitle:p?.title})]})]})}export{pe as default};
