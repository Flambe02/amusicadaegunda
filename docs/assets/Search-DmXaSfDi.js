import{r,j as t,L as R}from"./vendor-react-CM84WoKi.js";import{u as V,S as H,t as Q,e as F}from"./index-qLA7x5O3.js";import{u as W,Y as D,P as G,n as K}from"./vendor-ui-8p2QWU2G.js";import"./vendor-supabase-ci4wIQv9.js";import"./vendor-date-HUzpq8ep.js";const E=[{label:"Jan",full:"Janeiro",index:0,color:"#3B82F6"},{label:"Fev",full:"Fevereiro",index:1,color:"#6366F1"},{label:"Mar",full:"MarÃ§o",index:2,color:"#EC4899"},{label:"Abr",full:"Abril",index:3,color:"#F97316"},{label:"Mai",full:"Maio",index:4,color:"#10B981"},{label:"Jun",full:"Junho",index:5,color:"#EAB308"},{label:"Jul",full:"Julho",index:6,color:"#F59E0B"},{label:"Ago",full:"Agosto",index:7,color:"#EF4444"},{label:"Set",full:"Setembro",index:8,color:"#8B5CF6"},{label:"Out",full:"Outubro",index:9,color:"#14B8A6"},{label:"Nov",full:"Novembro",index:10,color:"#06B6D4"},{label:"Dez",full:"Dezembro",index:11,color:"#F43F5E"}];function f(o){if(!o)return null;const g=/^\d{4}-\d{2}-\d{2}$/.test(o)?o+"T12:00:00":o,i=new Date(g);return isNaN(i.getTime())?null:i}function b(o){return(o||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function se(){V({title:"Pesquisar mÃºsicas - A MÃºsica da Segunda",description:"Encontre qualquer mÃºsica do projeto A MÃºsica da Segunda.",url:"/search",type:"website",robots:"noindex, follow"});const[o,g]=r.useState([]),[i,Y]=r.useState(!0),[p,A]=r.useState(""),[u,v]=r.useState(new Set),[x,B]=r.useState(new Set),[P,T]=r.useState(new Set),w=r.useRef(null),[S,z]=r.useState(null),[y,I]=r.useState(null),[k,j]=r.useState("stopped");r.useEffect(()=>{H.list("-release_date").then(e=>{const l=e||[];g(l);const s=new Set;l.forEach(c=>{const a=f(c.release_date);a&&s.add(a.getFullYear())}),v(s),Y(!1)})},[]);const _=r.useMemo(()=>{const e=new Set;return o.forEach(l=>{const s=f(l.release_date);s&&e.add(s.getFullYear())}),[...e].sort((l,s)=>s-l)},[o]),d=r.useMemo(()=>{const e=b(p.trim()),l=e.length>0,s=u.size>0,c=x.size>0;return!l&&!s&&!c?[]:o.filter(a=>{const n=f(a.release_date),M=!l||b(a.title).includes(e)||b(a.artist).includes(e)||b(a.description).includes(e)||n&&String(n.getFullYear()).includes(e),m=!s||n&&u.has(n.getFullYear()),h=!c||n&&x.has(n.getMonth());return M&&m&&h})},[p,u,x,o]),N=p.trim().length>0||u.size>0||x.size>0,q=e=>{v(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},J=e=>{B(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},L=e=>{T(l=>{const s=new Set(l);return s.has(e)?s.delete(e):s.add(e),s})},C=e=>{w.current?.contentWindow?.postMessage(JSON.stringify({event:"command",func:e,args:[]}),"*")},$=e=>{const l=F(e.youtube_url);l&&(S===e.id?k==="playing"?(C("pauseVideo"),j("paused")):(C("playVideo"),j("playing")):(z(e.id),I(l),j("playing")))};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-sky-50 via-white to-blue-50",children:[y&&t.jsx("iframe",{ref:w,src:`https://www.youtube-nocookie.com/embed/${y}?enablejsapi=1&autoplay=1&rel=0`,title:"player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",style:{position:"fixed",top:"-9999px",left:"-9999px",width:"1px",height:"1px",opacity:0,pointerEvents:"none"}},y),t.jsxs("div",{className:"text-center pt-6 pb-4 px-4",children:[t.jsx("h1",{className:"text-3xl font-black text-gray-800 tracking-tight",children:"Pesquisar"}),t.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Encontre uma mÃºsica do projeto"})]}),t.jsxs("div",{className:"max-w-2xl mx-auto px-4 pb-24",children:[t.jsxs("div",{className:"relative mb-5",children:[t.jsx(W,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"}),t.jsx("input",{type:"search",autoFocus:!0,value:p,onChange:e=>A(e.target.value),placeholder:"Pesquisar mÃºsica, artista, ano...",className:"w-full pl-12 pr-4 py-4 rounded-2xl border border-gray-200 bg-white shadow-sm text-gray-800 text-base focus:outline-none focus:ring-2 focus:ring-[#32a2dc]/40 focus:border-[#32a2dc] transition-all"})]}),_.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"Ano"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(e=>{const l=u.has(e);return t.jsx("button",{onClick:()=>q(e),className:"px-4 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:l?{backgroundColor:"#1a1a2e",borderColor:"#1a1a2e",color:"#fff"}:{backgroundColor:"#fff",borderColor:"#1a1a2e33",color:"#1a1a2e"},children:e},e)})})]}),t.jsxs("div",{className:"mb-5",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"MÃªs"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(e=>{const l=x.has(e.index);return t.jsx("button",{onClick:()=>J(e.index),title:e.full,className:"px-3 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:l?{backgroundColor:e.color,borderColor:e.color,color:"#fff"}:{backgroundColor:"#fff",borderColor:e.color+"55",color:e.color},children:e.label},e.index)})})]}),N&&!i&&t.jsx("p",{className:"text-xs text-gray-400 mb-4 px-1",children:d.length===0?"Nenhuma mÃºsica encontrada":`${d.length} mÃºsica${d.length>1?"s":""} encontrada${d.length>1?"s":""}`}),i&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[#32a2dc] border-t-transparent rounded-full animate-spin"})}),!i&&!N&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-300",children:[t.jsx(D,{className:"w-16 h-16 mb-4"}),t.jsx("p",{className:"text-base font-medium text-center",children:"Digite uma palavra ou escolha um mÃªs"})]}),!i&&N&&d.length>0&&t.jsx("div",{className:"space-y-3",children:d.map(e=>{const l=Q(e.title),s=f(e.release_date),c=s?s.getMonth():null,a=c!==null?E[c].color:"#32a2dc",n=F(e.youtube_url),m=S===e.id&&k==="playing",h=P.has(e.id),O=(e.description||"").trim().length>160;return t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"h-1 w-full",style:{backgroundColor:a}}),t.jsxs("div",{className:"px-5 py-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:a+"18"},children:t.jsx(D,{className:"w-4 h-4",style:{color:a}})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"min-w-0 flex-1",children:l?t.jsx(R,{to:`/musica/${l}/`,className:"text-base font-black text-gray-800 hover:text-[#32a2dc] transition-colors leading-tight block truncate",children:e.title}):t.jsx("p",{className:"text-base font-black text-gray-800 leading-tight truncate",children:e.title})}),n&&t.jsx("button",{onClick:()=>$(e),className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110 shadow-sm",style:{backgroundColor:m?a:a+"22"},"aria-label":m?"Pausar":"Tocar",children:m?t.jsx(G,{className:"w-3.5 h-3.5 text-white"}):t.jsx(K,{className:"w-3.5 h-3.5 ml-0.5",style:{color:a}})})]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[e.artist,s&&t.jsxs("span",{className:"text-gray-400 ml-2",children:["Â· ",s.toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"})]})]})]})]}),e.description&&t.jsxs("div",{className:"pl-12 mt-2",children:[t.jsx("p",{className:`text-sm text-gray-600 leading-relaxed ${h?"":"line-clamp-3"}`,children:e.description}),O&&t.jsx("button",{type:"button",onClick:()=>L(e.id),className:"mt-1.5 text-xs font-semibold text-[#32a2dc] hover:text-[#2589b8] underline underline-offset-2",children:h?"Ver menos":"Ler mais"})]}),(e.spotify_url||e.youtube_music_url||e.apple_music_url)&&t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pl-12",children:[e.spotify_url&&t.jsx("a",{href:e.spotify_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-[#1DB954]/10 text-[#1DB954] text-xs font-bold hover:bg-[#1DB954]/20 transition-colors",children:"ðŸŽ§ Spotify"}),e.apple_music_url&&t.jsx("a",{href:e.apple_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-pink-50 text-pink-600 text-xs font-bold hover:bg-pink-100 transition-colors",children:"ðŸŽµ Apple Music"}),e.youtube_music_url&&t.jsx("a",{href:e.youtube_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-red-50 text-red-600 text-xs font-bold hover:bg-red-100 transition-colors",children:"ðŸ“± Video"})]})]})]},e.id)})})]})]})}export{se as default};
