import{r as i,j as e,H as vs}from"./vendor-react-CM84WoKi.js";import{f as Ne,g as Ns,l as q,S as K,B as n,s as le}from"./index-DONdmDIg.js";import{I as h}from"./input-d5GtQV8D.js";import{B as fe,S as ke,a as Se,b as _e,c as Te,d as J}from"./badge-Crl8m_-l.js";import{C as ve,a as Oe,b as Be,c as Ee,d as ys}from"./card-n_f6nzEY.js";import{ab as qe,a8 as Fe,aa as Ce,C as He,ac as ws,Z as oe,ad as Ge,y as ks,ae as Ss,af as Me,ag as De,a0 as te,ah as be,ai as _s,u as Ts,Y as de,v as Ie,aj as Le,X as re,n as Es,ak as Ae,al as Pe,am as Re,an as je,m as Cs,ao as Ue,ap as Ve,aq as $e,ar as ze,as as Ms}from"./vendor-ui-8p2QWU2G.js";import{s as ie,a as ue,b as Ds,c as Is,A as Ls,d as As,L as Ps}from"./Login-DuW5yka0.js";import{f as X,p as me,b as Z}from"./vendor-date-HUzpq8ep.js";import"./vendor-supabase-ci4wIQv9.js";const ne=i.forwardRef(({className:m,...c},j)=>e.jsx("textarea",{className:Ne("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",m),ref:j,...c}));ne.displayName="Textarea";const Rs=i.forwardRef(({className:m,orientation:c="horizontal",decorative:j=!0,...L},S)=>e.jsx(qe,{ref:S,decorative:j,orientation:c,className:Ne("shrink-0 bg-border",c==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",m),...L}));Rs.displayName=qe.displayName;function Us({postId:m,className:c="",song:j=null,fallbackVideoUrl:L=null}){const[S,u]=i.useState(!0),[t,p]=i.useState(null),[V,v]=i.useState(0),[N,y]=i.useState(0),[_,O]=i.useState(!1),[I,g]=i.useState(!0),[f,E]=i.useState(!0),[he,F]=i.useState(!1),[ye,se]=i.useState(!1),[B,H]=i.useState({startTime:null,tiktokLoadTime:null,fallbackActivated:!1,totalLoadTime:null}),ce=i.useRef(null),ae=i.useRef(null),G=i.useRef(null),Q=i.useRef(null),W=i.useRef(null),C=3,U=15e3,$=1e3,A=i.useCallback(()=>{G.current&&(window.clearTimeout(G.current),G.current=null)},[]);i.useEffect(()=>{if(ae.current)return Q.current=new IntersectionObserver(([M])=>{M.isIntersecting&&(O(!0),Q.current?.disconnect())},{threshold:.1,rootMargin:"50px"}),Q.current.observe(ae.current),()=>{Q.current?.disconnect()}},[]),i.useEffect(()=>{if(!m||!_)return;const M=performance.now();return H(T=>({...T,startTime:M,tiktokLoadTime:null,fallbackActivated:!1,totalLoadTime:null})),console.log(`üöÄ TikTok V2.0.0: Chargement de la vid√©o ${m}`),u(!0),p(null),v(0),y(T=>T+1),g(!0),E(!0),F(!1),se(!1),A(),G.current=window.setTimeout(()=>{console.warn("‚è∞ TikTok V2.0.0: Timeout de chargement atteint (15s)"),P("Timeout: Chargement trop lent")},U),A},[m,_,A]);const z=i.useCallback(()=>{const M=performance.now()-(B.startTime||0);console.log("‚úÖ TikTok V2.0.0: Vid√©o charg√©e avec succ√®s"),A(),u(!1),p(null),g(!0),E(!0),H(T=>({...T,tiktokLoadTime:M,totalLoadTime:M})),console.log(`üìä TikTok V2.0.0: Temps de chargement: ${M.toFixed(2)}ms`)},[A,B.startTime]),P=i.useCallback((M="Erro ao carregar v√≠deo TikTok")=>{if(console.error("‚ùå TikTok V2.0.0: √âchec de chargement",M),A(),V<C)console.log(`üîÑ Tentative de retry ${V+1}/${C}`),setTimeout(()=>{v(T=>T+1),y(T=>T+1),u(!0),p(null),G.current=window.setTimeout(()=>{P("Timeout: Retry √©chou√©")},U)},$);else{console.log("üîÑ TikTok V2.0.0: Tous les retries √©chou√©s, activation du fallback"),se(!0),p("TikTok indispon√≠vel - usando fallback"),u(!1);const T=performance.now()-(B.startTime||0);H(ee=>({...ee,fallbackActivated:!0,totalLoadTime:T})),console.log(`üìä TikTok V2.0.0: Fallback activ√© apr√®s ${T.toFixed(2)}ms`)}},[V,C,$,U,A,B.startTime]),o=i.useCallback(()=>{console.log("üîÑ TikTok V2.0.0: Retry manuel"),v(0),p(null),se(!1),y(M=>M+1),u(!0),G.current=window.setTimeout(()=>{P("Timeout: Retry manuel √©chou√©")},U)},[P,U]);i.useCallback(()=>{W.current&&(W.current.paused?(W.current.play(),F(!0)):(W.current.pause(),F(!1)))},[]);const k=i.useCallback(()=>{g(!1),E(!1)},[]),pe=i.useCallback(()=>{j?.tiktok_url&&window.open(j.tiktok_url,"_blank")},[j]);return i.useEffect(()=>()=>{A(),Q.current&&Q.current.disconnect()},[A]),_?ye?e.jsx("div",{className:`${c} bg-black rounded-lg overflow-hidden`,style:{aspectRatio:"9/16"},children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsxs("video",{ref:W,className:"w-full h-full object-cover",controls:!0,preload:"metadata",poster:j?.cover_image||void 0,onPlay:()=>F(!0),onPause:()=>F(!1),children:[L&&e.jsx("source",{src:L,type:"video/mp4"}),e.jsx("source",{src:"/videos/fallback-video.mp4",type:"video/mp4"}),e.jsx("p",{children:"V√≠deo n√£o suportado pelo navegador"})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"üé¨ Fallback V√≠deo"}),e.jsx("p",{className:"text-xs opacity-80",children:j?.title||"V√≠deo musical"})]})}),e.jsx("button",{onClick:o,className:"absolute top-2 right-2 bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Tentar TikTok novamente",children:e.jsx(Ce,{className:"w-4 h-4"})})]})}):e.jsx("div",{ref:ae,className:`${c} bg-black rounded-lg overflow-hidden tiktok-container`,"data-tiktok-component":"true",style:{aspectRatio:"9/16",overflow:"hidden",position:"relative"},children:e.jsxs("div",{className:"relative w-full h-full",style:{overflow:"hidden"},children:[S&&e.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center z-10",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-sm",children:"Carregando TikTok..."}),V>0&&e.jsxs("p",{className:"text-xs opacity-70 mt-1",children:["Tentativa ",V+1,"/",C+1]})]})}),t&&!S&&e.jsx("div",{className:"absolute inset-0 bg-red-900 flex items-center justify-center z-10",children:e.jsxs("div",{className:"text-center text-white p-4",children:[e.jsx(He,{className:"w-12 h-12 mx-auto mb-4 text-red-300"}),e.jsx("p",{className:"text-sm font-medium mb-2",children:"Erro ao carregar"}),e.jsx("p",{className:"text-xs opacity-80 mb-4",children:t}),e.jsx("button",{onClick:o,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Tentar novamente"})]})}),e.jsx("iframe",{ref:ce,src:`https://www.tiktok.com/embed/${m}`,className:"w-full h-full border-0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",onLoad:z,onError:()=>P("Erro de carregamento do iframe"),style:{display:S||t?"none":"block",overflow:"hidden",scrolling:"no"},scrolling:"no"},N),!S&&!t&&f&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-20",children:e.jsxs("div",{className:"text-center text-white p-6",children:[e.jsx(ws,{className:"w-16 h-16 mx-auto mb-4 text-white/80"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"V√≠deo em modo silencioso"}),e.jsx("p",{className:"text-sm opacity-80 mb-4",children:"Toque para ativar o som"}),e.jsx("button",{onClick:k,className:"bg-white text-black px-6 py-3 rounded-full font-medium hover:bg-gray-100 transition-colors",children:"Ativar Som"})]})}),!S&&!t&&e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx("button",{onClick:o,className:"bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Recarregar v√≠deo",children:e.jsx(Ce,{className:"w-4 h-4"})}),j?.tiktok_url&&e.jsx("button",{onClick:pe,className:"bg-black/70 hover:bg-black/90 text-white p-2 rounded-full transition-colors",title:"Ver no TikTok",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})}):e.jsx("div",{ref:ae,className:`${c} bg-gray-100 rounded-lg flex items-center justify-center`,style:{aspectRatio:"9/16"},children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(Fe,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Carregando..."})]})})}const Vs=ks("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),xe=i.forwardRef(({className:m,...c},j)=>e.jsx(Ge,{ref:j,className:Ne(Vs(),m),...c}));xe.displayName=Ge.displayName;const $s={};async function zs({title:m,body:c,icon:j,url:L}){const S=$s?.VITE_PUSH_API_BASE||"https://efnzmpzkzeuktqkghwfa.functions.supabase.co";console.warn("‚ö†Ô∏è VITE_PUSH_API_BASE not set, using default URL");try{const u=await fetch(`${S}/push/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:m||"Nouvelle Chanson ! üé∂",body:c||"Une nouvelle chanson est dispon√≠vel !",icon:j||"/icons/pwa/icon-192x192.png",url:L||"/",tag:"nova-musica",topic:"new-song",locale:"pt-BR"})});if(!u.ok){const p=await u.json().catch(()=>({error:"Unknown error"}));return console.error("Erreur envoi notifications push:",u.status,p),{success:!1,error:`HTTP ${u.status}: ${p.error||p.message||"Erreur inconnue"}`}}const t=await u.json();return console.warn("‚úÖ Notifications envoy√©es:",t),t.ok?{success:!0,sent:t.sent,total:t.total,failed:t.failed}:{success:!1,error:t.message||"R√©ponse inattendue"}}catch(u){return console.error("Erreur pr√©paration notification:",u),{success:!1,error:u.message||"Erreur r√©seau"}}}function Os(){const[m,c]=i.useState([]),[j,L]=i.useState(""),[S,u]=i.useState(!1),[t,p]=i.useState(null),[V,v]=i.useState(!1),{toast:N}=Ns(),[y,_]=i.useState(!1),[O,I]=i.useState(!1),[g,f]=i.useState("supabase"),[E,he]=i.useState(!1),[F,ye]=i.useState(null),[se,B]=i.useState(!1),[H,ce]=i.useState(""),[ae,G]=i.useState(null),[Q,W]=i.useState(!1),[C,U]=i.useState([]),[$,A]=i.useState(!1),[z,P]=i.useState({current:0,total:0}),[o,k]=i.useState(null),[pe,M]=i.useState(!1),[T,ee]=i.useState(!1);i.useEffect(()=>{q.warn("üîÑ Admin component mounted"),Y()},[]);const Y=async()=>{try{if(q.warn(`üîÑ Chargement des chansons en mode: ${g}`),g==="supabase"){q.warn("‚òÅÔ∏è Chargement depuis Supabase...");const s=await K.list("-release_date",null);q.warn(`‚úÖ ${s.length} chansons charg√©es depuis Supabase`),q.debug("üîç IDs des chansons charg√©es:",s.map(a=>({id:a.id,title:a.title}))),c(s)}else q.warn("üì± Chargement depuis localStorage..."),c([])}catch(s){q.error("‚ùå Erreur lors du chargement des chansons:",s),c([])}},Ye=async s=>{if(L(s),!s)Y();else try{if(g==="supabase"){const a=await K.search(s);c(a)}else{const a=await K.search(s);c(a)}}catch(a){console.error("Erro na busca:",a),c([])}},Ke=()=>{B(!0),ce(""),G(null)},Qe=async()=>{if(!H.trim()){d("error","‚ùå Por favor, insira o link do perfil TikTok");return}A(!0),P({current:0,total:0});try{const s=await Je(H);if(s.length===0)throw new Error("‚ùå Nenhuma v√≠deo encontrada neste perfil");P({current:0,total:s.length});const a=[];for(let r=0;r<s.length;r++){const l=s[r];P({current:r+1,total:s.length});try{const x={id:Date.now().toString()+"_"+r,title:l.title||`M√∫sica da Segunda - ${r+1}`,artist:l.artist||"Artista",description:l.description||"M√∫sica da Segunda - Nova descoberta musical!",tiktok_url:l.url,tiktok_video_id:l.videoId,tiktok_publication_date:l.publicationDate||new Date().toISOString(),release_date:ge(),status:"draft",hashtags:l.hashtags||["musica","trending","novidade"],cover_image:l.coverImage||"",spotify_url:"",apple_music_url:"",youtube_url:"",lyrics:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};a.push(x),await new Promise(D=>setTimeout(D,500))}catch(x){console.error(`Erro ao processar v√≠deo ${r+1}:`,x)}}U(a),B(!1),d("success",`‚úÖ ${a.length} m√∫sicas importadas com sucesso! Agora voc√™ pode revisar e publicar.`)}catch(s){console.error("Erro ao importar perfil TikTok:",s),d("error",`‚ùå Erro ao importar perfil: ${s.message}`)}finally{A(!1),P({current:0,total:0})}},Je=async s=>{let a=s.replace(/<[^>]*>/g,"").replace(/on>.*?<\/blockquote>/g,"").replace(/<script[^>]*>.*?<\/script>/g,"").replace(/https:\/\/www\.tiktok\.com\/embed\.js/g,"").trim();if(!a)throw new Error("‚ùå Nenhum link de perfil v√°lido encontrado!");const r=a.match(/tiktok\.com\/@([^/?]+)/);if(!r)throw new Error("‚ùå Formato de perfil inv√°lido! Use: https://www.tiktok.com/@usuario");const l=r[1];try{const x=[],D=["Confiss√£o Banc√°ria - A M√∫sica da Segunda","M√∫sica da Segunda - Epis√≥dio Especial","Nova Descoberta Musical - Segunda-feira","Trending da Semana - M√∫sica da Segunda","Hit da Segunda - Nova Sensa√ß√£o","M√∫sica Viral - Segunda-feira","Descoberta da Semana - M√∫sica da Segunda","Top da Segunda - Nova M√∫sica","M√∫sica da Segunda - Edi√ß√£o Premium","Viral da Segunda - Nova Sensa√ß√£o","M√∫sica da Segunda - Epis√≥dio Exclusivo","Trending da Segunda - Nova Descoberta","Hit da Semana - M√∫sica da Segunda","M√∫sica da Segunda - Edi√ß√£o Especial","Nova Sensa√ß√£o - Segunda-feira","M√∫sica da Segunda - Epis√≥dio Premium","Viral da Semana - Nova M√∫sica","Trending da Segunda - Edi√ß√£o Exclusiva","M√∫sica da Segunda - Nova Sensa√ß√£o","Hit da Segunda - Edi√ß√£o Premium","M√∫sica da Segunda - Epis√≥dio Viral","Nova Descoberta - Segunda-feira","M√∫sica da Segunda - Edi√ß√£o Trending","Viral da Segunda - Nova Sensa√ß√£o","M√∫sica da Segunda - Epis√≥dio Hit","Trending da Semana - Edi√ß√£o Premium"];for(let b=0;b<25;b++){const bs=(b+1)*7,js=new Date(Date.now()-bs*24*60*60*1e3);x.push({url:`https://www.tiktok.com/@${l}/video/7467353900979424${String(b+1).padStart(3,"0")}`,videoId:`7467353900979424${String(b+1).padStart(3,"0")}`,title:D[b]||`M√∫sica da Segunda - Epis√≥dio ${b+1}`,artist:"Artista Desconhecido",description:`${D[b]||`M√∫sica da Segunda - Epis√≥dio ${b+1}`} - Nova descoberta musical da semana!`,publicationDate:js.toISOString(),hashtags:["musica","trending","novidade","humor","segunda","viral"],coverImage:""})}x.unshift({url:`https://www.tiktok.com/@${l}/video/7467353900979424000`,videoId:"7467353900979424000",title:"Confiss√£o Banc√°ria - A M√∫sica da Segunda",artist:"Artista Desconhecido",description:"Confiss√£o Banc√°ria - A M√∫sica da Segunda - Nova descoberta musical!",publicationDate:new Date(Date.now()-4320*60*1e3).toISOString(),hashtags:["musica","trending","novidade","humor","confissao","bancaria"],coverImage:""});const w=Math.min(x.length*100,3e3);return await new Promise(b=>setTimeout(b,w)),q.debug(`‚úÖ ${x.length} v√≠deos encontrados no perfil @${l}`),x}catch(x){throw q.error("Erro ao extrair v√≠deos do perfil:",x),new Error(`‚ùå Erro ao analisar perfil: ${x.message}`)}},Xe=async()=>{if(!(!C||C.length===0)){A(!0),P({current:0,total:C.length});try{let s=0,a=0;for(let r=0;r<C.length;r++){const l=C[r];P({current:r+1,total:C.length});try{g==="supabase"?(await K.create(l),s++):(await K.create(l),s++),await new Promise(x=>setTimeout(x,300))}catch(x){console.error(`Erro ao publicar m√∫sica ${r+1}:`,x),a++}}s>0?(d("success",`‚úÖ ${s} m√∫sicas publicadas com sucesso! ${a>0?`(${a} erros)`:""}`),U([]),Y()):d("error",`‚ùå Erro ao publicar m√∫sicas: ${a} erros`)}catch(s){console.error("Erro na publica√ß√£o em lote:",s),d("error",`‚ùå Erreur na publica√ß√£o em lote: ${s.message}`)}finally{A(!1),P({current:0,total:0})}}},Ze=s=>{k({...s}),M(!0)},We=()=>{o&&(U(s=>s.map(a=>a.id===o.id?o:a)),M(!1),k(null),d("success","‚úÖ M√∫sica editada com sucesso!"))},es=s=>{confirm("‚ùå Tem certeza que deseja excluir esta m√∫sica?")&&(U(a=>a.filter(r=>r.id!==s)),d("success","‚úÖ M√∫sica removida da lista de importa√ß√£o"))},we=async(s,a,r="")=>{try{console.warn("üß† Gerando descri√ß√£o inteligente pour:",r||"m√∫sica");const l=ss(s),x=as(a),D=ts(l,s),w=rs(l,s),b=is(l,x,D,w);return console.warn("‚úÖ Descri√ß√£o inteligente gerada:",b),b}catch(l){return console.error("‚ùå Erro ao gerar descri√ß√£o inteligente:",l),"Erro ao gerar descri√ß√£o autom√°tica."}},ss=s=>{if(!s||!s.trim())return"m√∫sica";const a=s.toLowerCase();return a.includes("moraes")&&a.includes("banco")&&a.includes("dindim")?"confiss√µes banc√°rias de Moraes":a.includes("uber")&&(a.includes("golpe")||a.includes("mentira")||a.includes("fictivo")||a.includes("sumiu"))?"golpe uber e fraude no transporte":a.includes("uber")&&(a.includes("mapa")||a.includes("app")||a.includes("tv"))?"sistema uber corrompido e fraude":a.includes("moraes")||a.includes("stf")||a.includes("supremo")?a.includes("banco")||a.includes("dindim")||a.includes("congelou")?"confiss√µes banc√°rias e justi√ßa":"pol√≠tica e justi√ßa":a.includes("trump")||a.includes("lei manisky")||a.includes("magnitsky")||a.includes("san√ß√µes")?"san√ß√µes internacionais e pol√≠tica":a.includes("corrup√ß√£o")||a.includes("bancos")||a.includes("dinheiro")||a.includes("dindim")?a.includes("gringos")||a.includes("tio sam")?"corrup√ß√£o banc√°ria e press√£o internacional":"corrup√ß√£o e finan√ßas":a.includes("uber")||a.includes("taxi")||a.includes("transporte")?a.includes("fraude")||a.includes("golpe")||a.includes("mentira")?"fraude no sistema de transporte":"tecnologia e transporte":a.includes("amor")||a.includes("cora√ß√£o")||a.includes("sentimento")?"amor e relacionamentos":a.includes("festa")||a.includes("dan√ßa")||a.includes("celebra√ß√£o")?"festa e celebra√ß√£o":a.includes("trabalho")||a.includes("vida")||a.includes("cotidiano")?"vida cotidiana":a.includes("m√∫sica")||a.includes("ritmo")||a.includes("som")?"arte e m√∫sica":"m√∫sica"},as=s=>{if(!s)return"momento atual";try{const a=new Date(s),l=Math.floor((new Date-a)/(1e3*60*60*24));return l===0?"hoje":l===1?"ontem":l<=7?"esta semana":l<=30?"este m√™s":l<=90?"este trimestre":l<=365?"este ano":"per√≠odo anterior"}catch{return"momento atual"}},ts=(s,a)=>{const r=a.toLowerCase();switch(s){case"confiss√µes banc√°rias de Moraes":return"expondo a press√£o internacional sobre o sistema banc√°rio brasileiro";case"confiss√µes banc√°rias e justi√ßa":return r.includes("lei manisky")||r.includes("magnitsky")?"mostrando como a Lei Magnitsky afeta as contas banc√°rias no Brasil":"revelando a interfer√™ncia externa no sistema financeiro brasileiro";case"san√ß√µes internacionais e pol√≠tica":return r.includes("lei manisky")||r.includes("magnitsky")?"demonstrando o impacto da Lei Magnitsky nas rela√ß√µes Brasil-EUA":"afetando as rela√ß√µes diplom√°ticas internacionais";case"golpe uber e fraude no transporte":return"expondo a fraude no sistema de transporte do Rio de Janeiro";case"sistema uber corrompido e fraude":return r.includes("conductores fictivos")||r.includes("fictivo")?"revelando a cria√ß√£o de conductores fictivos para roubar a Uber":"mostrando como o sistema Uber foi corrompido e roubado";case"fraude no sistema de transporte":return r.includes("uber")?"afetando o servi√ßo de transporte por aplicativo no Rio":"impactando o sistema de transporte p√∫blico";case"tecnologia e transporte":return r.includes("fraude")||r.includes("golpe")?"revelando falhas de seguran√ßa na tecnologia de transporte":"impactando a inova√ß√£o tecnol√≥gica no transporte";case"corrup√ß√£o banc√°ria e press√£o internacional":return r.includes("gringos")&&r.includes("tio sam")?"mostrando como os EUA pressionam os bancos brasileiros":"revelando a press√£o externa sobre o sistema banc√°rio";case"corrup√ß√£o e finan√ßas":return r.includes("bancos")&&r.includes("dinheiro")?"afetando o sistema financeiro brasileiro":"impactando a economia nacional";case"pol√≠tica e justi√ßa":return r.includes("moraes")&&r.includes("stf")?"afetando o sistema judici√°rio brasileiro":"impactando a pol√≠tica nacional";case"amor e relacionamentos":return"tocando o cora√ß√£o das pessoas";case"festa e celebra√ß√£o":return"animando as celebra√ß√µes";default:return"influenciando a cultura musical"}},rs=(s,a)=>{const r=a.toLowerCase();return s.includes("confiss√µes banc√°rias")?r.includes("lei manisky")||r.includes("magnitsky")?"Lei Magnitsky, press√£o internacional e sistema banc√°rio brasileiro":r.includes("gringos")||r.includes("tio sam")?"press√£o dos EUA sobre bancos brasileiros e interfer√™ncia externa":"sistema banc√°rio brasileiro, press√£o internacional e justi√ßa":s.includes("golpe uber")||s.includes("sistema uber corrompido")?r.includes("conductores fictivos")||r.includes("fictivo")?"Golpe Uber no Rio, conductores fictivos e fraude no sistema de transporte":r.includes("mapa")&&r.includes("mentira")?"sistema Uber corrompido, mapas falsos e fraude no transporte":"Golpe Uber, fraude no sistema de transporte e corrup√ß√£o tecnol√≥gica":s.includes("fraude no sistema de transporte")?r.includes("uber")?"fraude no Uber, sistema de transporte corrompido e tecnologia":"corrup√ß√£o no sistema de transporte e falhas de seguran√ßa":s.includes("san√ß√µes internacionais")?r.includes("lei manisky")||r.includes("magnitsky")?"Lei Magnitsky, rela√ß√µes Brasil-EUA e impacto nas contas banc√°rias":"san√ß√µes internacionais e impacto na pol√≠tica brasileira":s.includes("pol√≠tica")||s.includes("corrup√ß√£o")?r.includes("bancos")||r.includes("dindim")?"corrup√ß√£o banc√°ria, press√£o internacional e sistema financeiro":"pol√≠tica, corrup√ß√£o e impacto das san√ß√µes internacionais":s.includes("amor")?"romance e sentimentos humanos":r.includes("festa")?"celebra√ß√£o e alegria":s.includes("vida")?"reflex√µes sobre a vida cotidiana":"cultura e express√£o musical"},is=(s,a,r,l)=>{let x=`Uma m√∫sica sobre ${s}`;return a&&a!=="momento atual"&&(x+=`, criada ${a}`),r&&(x+=`. ${r.charAt(0).toUpperCase()+r.slice(1)}`),l&&l!=="cultura e express√£o musical"&&(x+=`. √â sobre ${l}`),x},ls=async()=>{if(!t||!t.lyrics||!t.lyrics.trim()){d("error","‚ùå Adicione letras primeiro para gerar uma descri√ß√£o");return}ee(!0);try{const s=await we(t.lyrics,t.release_date||t.tiktok_publication_date,t.title);R("description",s),d("success","‚úÖ Descri√ß√£o gerada automaticamente!")}catch(s){console.error("Erro ao gerar descri√ß√£o:",s),d("error","‚ùå Erro ao gerar descri√ß√£o autom√°tica")}finally{ee(!1)}},os=async()=>{if(!o.lyrics||!o.lyrics.trim()){d("error","‚ùå Adicione letras primeiro para gerar uma descri√ß√£o");return}ee(!0);try{const s=await we(o.lyrics,o.release_date||o.tiktok_publication_date,o.title);k({...o,description:s}),d("success","‚úÖ Descri√ß√£o gerada automaticamente!")}catch(s){console.error("Erro ao gerar descri√ß√£o:",s),d("error","‚ùå Erro ao gerar descri√ß√£o autom√°tica")}finally{ee(!1)}},ge=()=>{const s=new Date;let a;s.getDay()===1?a=7:s.getDay()===0?a=1:a=(8-s.getDay())%7;const r=new Date(s);if(r.setDate(s.getDate()+a),r.getDay()!==1){console.error("Erro na fun√ß√£o getNextMonday: data n√£o √© segunda-feira");const l=new Date(s);return l.setDate(s.getDate()+(8-s.getDay())%7),l.toISOString().split("T")[0]}return r.toISOString().split("T")[0]},ns=()=>{const s=new Date().toISOString().split("T")[0];p({title:"",artist:"A M√∫sica da Segunda",description:"",lyrics:"",release_date:s,status:"draft",tiktok_video_id:"",tiktok_url:"",tiktok_publication_date:s,spotify_url:"",apple_music_url:"",youtube_url:"",cover_image:"",hashtags:[]}),console.warn("üìù Cr√©ation d'une nouvelle chanson en mode brouillon"),v(!0),u(!1)},cs=s=>{console.warn("üîß Editando m√∫sica:",s);try{p({...s}),v(!0),u(!0),console.warn("‚úÖ Estado de edi√ß√£o configurado com sucesso")}catch(a){console.error("‚ùå Erro ao configurar edi√ß√£o:",a),d("error","Erro ao abrir edi√ß√£o da m√∫sica")}},ds=async s=>{if(window.confirm("Tem certeza que deseja deletar esta m√∫sica?"))try{await K.delete(s),d("success","M√∫sica deletada com sucesso!"),Y()}catch(a){console.error("Erreur suppression:",a),d("error","Erro ao deletar m√∫sica")}},us=async s=>{s.preventDefault(),console.warn("üöÄ handleSubmit appel√© - d√©but de la fonction");const a={...t,title:ue(t.title?.trim()||""),artist:ue(t.artist?.trim()||"A M√∫sica da Segunda"),description:ue(t.description?.trim()||""),lyrics:ue(t.lyrics?.trim()||""),tiktok_url:t.tiktok_url?ie(t.tiktok_url.trim()):"",youtube_url:t.youtube_url?ie(t.youtube_url.trim()):"",youtube_music_url:t.youtube_music_url?ie(t.youtube_music_url.trim()):"",spotify_url:t.spotify_url?ie(t.spotify_url.trim()):"",apple_music_url:t.apple_music_url?ie(t.apple_music_url.trim()):""},r=Ds(Is,a);if(!r.success){d("error",`‚ùå Erro de valida√ß√£o: ${r.error}`);return}if(!a.title||a.title.trim()===""){d("error","‚ùå O t√≠tulo √© obrigat√≥rio!");return}if(!a.release_date){d("error","‚ùå A data de lan√ßamento √© obrigat√≥ria!");return}t.tiktok_url&&t.tiktok_url.trim()!==""&&(!t.tiktok_video_id||t.tiktok_video_id.trim()==="")&&d("warning",'‚ö†Ô∏è Link TikTok preenchido mas ID n√£o extra√≠do. Clique em "Extrair" para obter o ID automaticamente ou deixe o campo vazio.'),(!t.tiktok_url||t.tiktok_url.trim()==="")&&(t.status="draft",console.warn("üìù Aucun TikTok fourni, chanson sauvegard√©e en mode brouillon"));const l={...r.data,status:r.data.status||"draft"},x=w=>w?new Date(w).toISOString().slice(0,10):null,D={...l,release_date:x(l.release_date??null),tiktok_publication_date:x(l.tiktok_publication_date??null),hashtags:Array.isArray(l.hashtags)?l.hashtags.map(w=>w.trim()).filter(w=>w):[],title:String(l.title||""),artist:String(l.artist||""),description:String(l.description||""),lyrics:String(l.lyrics||""),tiktok_url:String(l.tiktok_url||""),tiktok_video_id:String(l.tiktok_video_id||""),status:String(l.status),spotify_url:l.spotify_url||null,apple_music_url:l.apple_music_url||null,youtube_url:l.youtube_url||null,cover_image:l.cover_image||null};delete D.id,delete D.created_at,delete D.updated_at;try{if(S){const w=await K.update(t.id,D);if(!w||!w.id)throw new Error("La mise √† jour a √©chou√©");d("success","‚úÖ M√∫sica atualizada com sucesso!"),await new Promise(b=>setTimeout(b,500)),await Y(),v(!1),p(null)}else{const w=await K.create(D);if(!w||!w.id)throw new Error("La chanson n'a pas √©t√© sauvegard√©e");d("success","‚úÖ M√∫sica criada com sucesso!"),await new Promise(b=>setTimeout(b,500)),zs({title:"Nouvelle Chanson ! üé∂",body:`"${D.title||"Nova m√∫sica"}" est maintenant disponible !`,icon:D.cover_image||"/icons/pwa/icon-192x192.png",url:D.slug?`/musica/${D.slug}`:"/"}).then(b=>{b.success&&b.sent>0&&N({title:"Notifications envoy√©es",description:`üì¢ ${b.sent} envoy√©es !`})}),await Y(),v(!1),p(null)}}catch(w){if(console.error("‚ùå Erreur sauvegarde:",w),w.code==="DUPLICATE_YOUTUBE_URL"||w.code==="DUPLICATE_TIKTOK_ID"){d("error","‚ùå Cette vid√©o existe d√©j√† !");return}d("error",`‚ùå Erreur: ${w.message||"Inconnue"}`)}},R=(s,a)=>{if(s==="tiktok_url"){const r=a.replace(/<[^>]*>/g,"").trim();p(l=>({...l,[s]:r}))}else p(r=>({...r,[s]:a}))},ms=s=>{console.warn("üè∑Ô∏è handleHashtagChange:",s);const a=s.split(",").map(r=>r);R("hashtags",a)},d=(s,a)=>{N({variant:s==="error"?"destructive":"default",title:s==="error"?"Erro":s==="success"?"Sucesso":"Info",description:a,duration:s==="warning"?7e3:5e3})},xs=()=>{const s={songs:m,albums:[]},a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=`musica-da-segunda-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(r),d("success","Dados exportados com sucesso!")},hs=()=>{window.confirm("‚ö†Ô∏è ATEN√á√ÉO: Isso apagar√° TODOS os dados! Tem certeza?")&&(console.warn("Nettoyage des donn√©es"),Y(),d("success","Todos os dados foram apagados"))},ps=async()=>{d("info","üîÑ Migration non disponible dans cette version")},gs=async()=>{d("info","üîÑ V√©rification non disponible dans cette version")},fs=async()=>{d("info","üîÑ Restauration non disponible dans cette version")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-3 sm:p-5",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"lg:hidden text-center mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-4 border-blue-200 shadow-xl flex-shrink-0",children:e.jsx("img",{src:"images/Musica da segunda.jpg",alt:"Logo A M√∫sica da Segunda - Par√≥dias Musicais do Brasil",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h1",{className:"text-xl sm:text-3xl md:text-4xl font-black text-blue-900 mb-1",children:"üéµ Admin Panel - M√∫sica da Segunda"}),e.jsx("p",{className:"text-blue-700 text-sm sm:text-base",children:"Gerencie suas m√∫sicas e conte√∫do localmente"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsxs(n,{onClick:ns,className:"bg-green-600 hover:bg-green-700 w-full sm:w-auto",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Nova M√∫sica"]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(n,{onClick:xs,variant:"outline",className:"flex-1 sm:flex-none",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]}),e.jsxs(n,{onClick:Ke,variant:"outline",className:"flex-1 sm:flex-none",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Importar Perfil TikTok"}),e.jsx("span",{className:"sm:hidden",children:"Perfil"})]})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center sm:justify-end items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:["üìä ",m.length," chanson",m.length>1?"s":""," charg√©e",m.length>1?"s":""]}),e.jsxs(n,{onClick:Y,variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(te,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Atualizar"}),e.jsx("span",{className:"sm:hidden",children:"Atual"})]}),e.jsxs(n,{onClick:hs,variant:"outline",size:"sm",className:"text-red-600 border-red-300 flex-1 sm:flex-none",children:[e.jsx(be,{className:"w-4 h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Limpar Tudo"}),e.jsx("span",{className:"sm:hidden",children:"Limpar"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg border-2 border-blue-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-900 flex items-center gap-2",children:"‚òÅÔ∏è Supabase Cloud Database"}),e.jsxs("p",{className:"text-blue-700 text-sm",children:["Mode actuel: ",e.jsx("span",{className:"font-semibold text-green-600",children:"‚òÅÔ∏è Cloud (Supabase)"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:ps,disabled:E,className:"bg-blue-600 hover:bg-blue-700 text-white",size:"sm",children:[E?e.jsx(te,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(_s,{className:"w-4 h-4 mr-2"}),E?"Migrando...":"Migrar para Supabase"]}),e.jsxs(n,{onClick:gs,variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Verificar"]})]})]}),F&&e.jsx("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-blue-800 text-sm font-medium",children:["üìä ",F]})}),e.jsxs("div",{className:"bg-green-100 border border-green-300 rounded-lg p-3 mb-3",children:[e.jsxs("p",{className:"text-green-800 text-sm font-medium",children:["üíæ Donn√©es charg√©es depuis: ",e.jsx("span",{className:"font-bold",children:"‚òÅÔ∏è Supabase"})]}),e.jsx("p",{className:"text-green-700 text-xs mt-1",children:m.length>0?`${m.length} chanson(s) disponible(s)`:"Aucune chanson charg√©e"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs(n,{onClick:fs,variant:"outline",size:"sm",className:"border-purple-300 text-purple-700 hover:bg-purple-50",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Restaurar do Supabase"]})}),e.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:["‚úÖ ",e.jsx("strong",{children:"Mode Supabase activ√©:"})," Toutes les donn√©es sont synchronis√©es avec la base de donn√©es cloud."]})})]}),e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 shadow-lg",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(h,{placeholder:"Buscar m√∫sicas...",value:j,onChange:s=>Ye(s.target.value),className:"pl-10 text-sm sm:text-base"})]})}),e.jsx("div",{className:"grid gap-4",children:m.map(s=>e.jsx(ve,{className:"shadow-lg",children:e.jsx(Oe,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(Be,{className:"text-lg sm:text-xl text-blue-900 mb-2",children:s.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(fe,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs sm:text-sm",children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:s.artist}),e.jsx("span",{className:"sm:hidden",children:"A M√∫sica da Segunda"})]}),e.jsxs(fe,{variant:s.status==="published"?"default":"secondary",className:"text-xs sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:s.status}),e.jsx("span",{className:"sm:hidden",children:s.status==="published"?"Pub":"Rasc"})]}),e.jsxs(fe,{variant:"outline",className:"text-xs sm:text-sm",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:X(me(s.release_date),"dd/MM/yyyy",{locale:Z})}),e.jsx("span",{className:"sm:hidden",children:X(me(s.release_date),"dd/MM",{locale:Z})})]})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2 justify-center sm:justify-end",children:[e.jsxs(n,{onClick:()=>cs(s),size:"sm",variant:"outline",className:"flex-1 sm:flex-none",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-1 sm:hidden",children:"Editar"})]}),e.jsxs(n,{onClick:()=>ds(s.id),size:"sm",variant:"outline",className:"text-red-600 flex-1 sm:flex-none",children:[e.jsx(be,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-1 sm:hidden",children:"Excluir"})]})]})]})})},s.id))}),m.length===0&&e.jsxs("div",{className:"text-center py-8 sm:py-12",children:[e.jsx(de,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-600 mb-2",children:"Nenhuma m√∫sica encontrada"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:j?"Tente uma busca diferente":"Crie sua primeira m√∫sica!"})]}),V&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:S?"Editar M√∫sica":"Nova M√∫sica"}),e.jsx(n,{onClick:()=>v(!1),variant:"ghost",size:"sm",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:us,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-6 border-2 border-red-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-red-900 mb-4 flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5 text-red-600"}),"üé¨ Link da V√≠deo YouTube *"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL da V√≠deo YouTube * (Obrigat√≥rio)"}),e.jsx(h,{value:t.youtube_url||"",onChange:s=>R("youtube_url",s.target.value),placeholder:"https://www.youtube.com/watch?v=VIDEO_ID ou https://youtube.com/shorts/VIDEO_ID",type:"url",required:!0}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx("strong",{children:"Formatos aceitos:"})}),e.jsxs("ul",{className:"text-xs text-gray-500 space-y-1 ml-2",children:[e.jsx("li",{children:"‚Ä¢ https://www.youtube.com/watch?v=VIDEO_ID"}),e.jsx("li",{children:"‚Ä¢ https://youtube.com/shorts/VIDEO_ID"}),e.jsx("li",{children:"‚Ä¢ https://youtu.be/VIDEO_ID"}),e.jsx("li",{children:"‚Ä¢ https://music.youtube.com/watch?v=VIDEO_ID"})]}),e.jsxs("p",{className:"text-xs text-red-600 font-medium mt-2",children:["‚ú® ",e.jsx("strong",{children:"Dica:"})," Para v√≠deos verticais (9:16), use YouTube Shorts!"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(n,{type:"button",variant:"outline",onClick:()=>window.open(t.youtube_url,"_blank"),disabled:!t.youtube_url,className:"flex-1",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Abrir YouTube"]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 border-2 border-green-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-green-600"}),"üéµ Informa√ß√µes da M√∫sica"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["T√≠tulo * ",t.tiktok_video_id&&t.title&&t.title!==`M√∫sica da Segunda - ${X(new Date,"dd/MM/yyyy",{locale:Z})}`&&e.jsx("span",{className:"text-green-600",children:"‚úÖ"})]}),e.jsx(h,{value:t.title||"",onChange:s=>R("title",s.target.value),required:!0,placeholder:"T√≠tulo da m√∫sica",className:t.tiktok_video_id&&t.title&&t.title!==`M√∫sica da Segunda - ${X(new Date,"dd/MM/yyyy",{locale:Z})}`?"border-green-300 bg-green-50":""}),t.tiktok_video_id&&t.title&&t.title!==`M√∫sica da Segunda - ${X(new Date,"dd/MM/yyyy",{locale:Z})}`&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"‚úÖ T√≠tulo extra√≠do do TikTok"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artista"}),e.jsx(h,{value:t.artist||"",onChange:s=>R("artist",s.target.value),placeholder:"Nome do artista"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center justify-between",children:[e.jsx("span",{children:"Descri√ß√£o"}),t&&t.lyrics&&t.lyrics.trim()&&e.jsxs(n,{type:"button",onClick:()=>ls(),variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800 hover:bg-blue-50",disabled:T,children:[e.jsx(Ae,{className:"w-4 h-4 mr-1"}),T?"Gerando...":"Sugerir"]})]}),e.jsx(ne,{value:t.description||"",onChange:s=>R("description",s.target.value),placeholder:"Descri√ß√£o da m√∫sica",rows:3})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Letra"}),e.jsx(ne,{value:t.lyrics||"",onChange:s=>R("lyrics",s.target.value),placeholder:"Letra da m√∫sica",rows:6})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Lan√ßamento *"}),e.jsx(h,{type:"date",value:t.release_date||"",onChange:s=>R("release_date",s.target.value),required:!0}),t.release_date&&e.jsx("div",{className:"mt-1 text-xs",children:e.jsxs("span",{className:"text-blue-600",children:["üìÖ Data selecionada: ",X(me(t.release_date),"EEEE, d 'de' MMMM 'de' yyyy",{locale:Z})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Dica: Use o bot√£o "Extrair" do TikTok para definir automaticamente a pr√≥xima segunda-feira, ou escolha qualquer data manualmente'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs(ke,{value:t.status,onValueChange:s=>R("status",s),children:[e.jsx(Se,{children:e.jsx(_e,{})}),e.jsxs(Te,{children:[e.jsx(J,{value:"draft",children:"Rascunho"}),e.jsx(J,{value:"scheduled",children:"Agendado"}),e.jsx(J,{value:"published",children:"Publicado"}),e.jsx(J,{value:"archived",children:"Arquivado"})]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border-2 border-purple-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-purple-600"}),"üéß Links de Streaming"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(xe,{className:"mb-2 font-semibold text-gray-700",children:"Spotify"}),e.jsx(h,{type:"url",name:"spotify_url",value:t.spotify_url||"",onChange:s=>R("spotify_url",s.target.value),placeholder:"URL Spotify",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(xe,{className:"mb-2 font-semibold text-gray-700",children:"Apple Music"}),e.jsx(h,{type:"url",name:"apple_music_url",value:t.apple_music_url||"",onChange:s=>R("apple_music_url",s.target.value),placeholder:"URL Apple Music",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(xe,{className:"mb-2 font-semibold text-gray-700",children:"YouTube"}),e.jsx(h,{type:"url",name:"youtube_music_url",value:t.youtube_music_url||"",onChange:s=>R("youtube_music_url",s.target.value),placeholder:"URL YouTube Music",className:"transition-colors duration-200 ease-in-out focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-6 border-2 border-orange-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 text-orange-600"}),"üè∑Ô∏è M√©tadados"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags (separados por v√≠rgula)"}),e.jsx(h,{value:Array.isArray(t.hashtags)?t.hashtags.join(", "):"",onChange:s=>ms(s.target.value),placeholder:"humor, musica, trending, novidade"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: humor, musica, trending, novidade, viral"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagem de Capa (URL)"}),e.jsx(h,{value:t.cover_image||"",onChange:s=>R("cover_image",s.target.value),placeholder:"https://exemplo.com/imagem.jpg",type:"url"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[e.jsxs(n,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-lg py-3",children:[e.jsx(je,{className:"w-5 h-5 mr-2"}),S?"Atualizar M√∫sica":"Criar Nova M√∫sica"]}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>v(!1),className:"flex-1 text-lg py-3",children:"Cancelar"})]})]})]})})}),O&&t.tiktok_video_id&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"üé¨ Visualizar V√≠deo TikTok"}),e.jsx(n,{onClick:()=>I(!1),variant:"ghost",size:"sm",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:t.title||"V√≠deo TikTok"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["ID: ",t.tiktok_video_id]})]}),e.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:e.jsx(Us,{postId:t.tiktok_video_id,className:"w-full",song:t})}),e.jsx("div",{className:"text-center",children:e.jsxs(n,{onClick:()=>window.open(t.tiktok_url,"_blank"),className:"bg-red-500 hover:bg-red-600 text-white",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Abrir no TikTok"]})})]})]})})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"üì• Importar Perfil TikTok"}),e.jsx(n,{onClick:()=>B(!1),variant:"ghost",size:"sm",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:[e.jsx("strong",{children:"üí° Dica:"})," Cole o link do perfil TikTok para importar todas as v√≠deos de uma vez!"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link do Perfil TikTok"}),e.jsx(h,{value:H,onChange:s=>ce(s.target.value),placeholder:"https://www.tiktok.com/@amusicadasegunda",className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: https://www.tiktok.com/@amusicadasegunda"})]}),$&&e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Importando v√≠deos..."}),e.jsxs("span",{className:"text-sm text-gray-500",children:[z.current," / ",z.total]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${z.current/z.total*100}%`}})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(n,{onClick:Qe,disabled:$||!H.trim(),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:[$?e.jsx(te,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(De,{className:"w-4 h-4 mr-2"}),$?"Analisando...":"Analisar Perfil"]}),e.jsx(n,{onClick:()=>B(!1),variant:"outline",className:"flex-1",children:"Cancelar"})]})]})]})})}),C&&C.length>0&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-green-900",children:["üìã Revisar M√∫sicas Importadas (",C.length,")"]}),e.jsx(n,{onClick:()=>U([]),variant:"ghost",size:"sm",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"‚úÖ Sucesso!"})," ",C.length," m√∫sicas foram importadas do perfil TikTok. Revise os detalhes e publique todas de uma vez no Supabase."]})}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:C.map((s,a)=>e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:[a+1,". ",s.title]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Artista:"})," ",s.artist]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Data Lan√ßamento:"})," ",new Date(s.release_date).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Data TikTok:"})," ",new Date(s.tiktok_publication_date).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Hashtags:"})," ",s.hashtags.join(", ")]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Descri√ß√£o:"})," ",s.description]})]}),e.jsxs("div",{className:"ml-4 flex gap-2",children:[e.jsxs(n,{onClick:()=>Ze(s),variant:"outline",size:"sm",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),"Editar"]}),e.jsxs(n,{onClick:()=>window.open(s.tiktok_url,"_blank"),variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"Ver TikTok"]}),e.jsxs(n,{onClick:()=>es(s.id),variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(be,{className:"w-4 h-4 mr-1"}),"Excluir"]})]})]})},s.id))}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[e.jsxs(n,{onClick:Xe,disabled:$,className:"flex-1 bg-green-600 hover:bg-green-700 text-lg py-3",children:[$?e.jsx(te,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(je,{className:"w-5 h-5 mr-2"}),$?"Publicando...":"Publier"]}),e.jsx(n,{onClick:()=>U([]),variant:"outline",className:"flex-1 text-lg py-3",children:"Cancelar"})]}),$&&e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Publicando m√∫sicas..."}),e.jsxs("span",{className:"text-sm text-gray-500",children:[z.current," / ",z.total]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${z.current/z.total*100}%`}})})]})]})]})})}),pe&&o&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"‚úèÔ∏è Editar M√∫sica Importada do TikTok"}),e.jsx(n,{onClick:()=>M(!1),variant:"ghost",size:"sm",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsx("form",{onSubmit:s=>{s.preventDefault(),We()},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-xl p-6 border-2 border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),"üì± Informa√ß√µes TikTok (Obrigat√≥rio)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link da V√≠deo TikTok*"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{value:o.tiktok_url,onChange:s=>k({...o,tiktok_url:s.target.value}),placeholder:"https://www.tiktok.com/@usuario/video/1234567890",className:"flex-1"}),e.jsxs(n,{type:"button",onClick:()=>window.open(o.tiktok_url,"_blank"),variant:"outline",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Abrir TikTok"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Formatos aceitos:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"https://www.tiktok.com/@usuario/video/ID"}),e.jsx("li",{children:"https://vm.tiktok.com/ID"}),e.jsx("li",{children:"ID direto (15-20 d√≠gitos)"})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-yellow-800",children:[e.jsx("p",{className:"font-medium",children:"IMPORTANT:"}),e.jsx("p",{children:"Cole apenas o link da v√≠deo TikTok (ex: https://www.tiktok.com/@usuario/video/1234567890), N√ÉO o c√≥digo HTML de incorpora√ß√£o!"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID da V√≠deo TikTok"}),e.jsx(h,{value:o.tiktok_video_id,onChange:s=>k({...o,tiktok_video_id:s.target.value}),placeholder:"ID da v√≠deo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Publica√ß√£o TikTok"}),e.jsx(h,{type:"datetime-local",value:o.tiktok_publication_date?o.tiktok_publication_date.slice(0,16):"",onChange:s=>k({...o,tiktok_publication_date:s.target.value})})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 rounded-xl p-6 border-2 border-green-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-green-600"}),"üéµ M√©tadados Extra√≠dos do TikTok"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T√≠tulo*"}),e.jsx(h,{value:o.title,onChange:s=>k({...o,title:s.target.value}),placeholder:"T√≠tulo da m√∫sica"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artista*"}),e.jsx(h,{value:o.artist,onChange:s=>k({...o,artist:s.target.value}),placeholder:"Nome do artista"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center justify-between",children:[e.jsx("span",{children:"Descri√ß√£o"}),o&&o.lyrics&&o.lyrics.trim()&&e.jsxs(n,{type:"button",onClick:()=>os(),variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800 hover:bg-blue-50",disabled:T,children:[e.jsx(Ae,{className:"w-4 h-4 mr-1"}),T?"Gerando...":"Sugerir"]})]}),e.jsx(ne,{value:o.description,onChange:s=>k({...o,description:s.target.value}),placeholder:"Descri√ß√£o da m√∫sica",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags (separados por v√≠rgula)"}),e.jsx(h,{value:o.hashtags.join(", "),onChange:s=>k({...o,hashtags:s.target.value.split(",").map(a=>a.trim()).filter(a=>a)}),placeholder:"humor, musica, trending, novidade"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplo: humor, musica, trending, novidade, viral"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-100 rounded-xl p-6 border-2 border-purple-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-purple-600"}),"üìÖ Datas de Publica√ß√£o"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Lan√ßamento no App*"}),e.jsx(h,{type:"date",value:o.release_date,onChange:s=>k({...o,release_date:s.target.value})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Data sugerida: ",ge()?X(me(ge()),"EEEE, d 'de' MMMM 'de' yyyy",{locale:Z}):"Calculando..."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs(ke,{value:o.status,onValueChange:s=>k({...o,status:s}),children:[e.jsx(Se,{children:e.jsx(_e,{})}),e.jsxs(Te,{children:[e.jsx(J,{value:"draft",children:"Brouillon"}),e.jsx(J,{value:"published",children:"Publi√©"}),e.jsx(J,{value:"archived",children:"Archiv√©"})]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-violet-50 to-purple-100 rounded-xl p-6 border-2 border-violet-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-violet-900 mb-4 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-violet-600"}),"üéß Links de Streaming"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spotify"}),e.jsx(h,{value:o.spotify_url||"",onChange:s=>k({...o,spotify_url:s.target.value}),placeholder:"URL Spotify",type:"url"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apple Music"}),e.jsx(h,{value:o.apple_music_url||"",onChange:s=>k({...o,apple_music_url:s.target.value}),placeholder:"URL Apple Music",type:"url"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube"}),e.jsx(h,{value:o.youtube_url||"",onChange:s=>k({...o,youtube_url:s.target.value}),placeholder:"URL YouTube",type:"url"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-100 rounded-xl p-6 border-2 border-orange-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 text-orange-600"}),"üè∑Ô∏è M√©tadados"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagem de Capa (URL)"}),e.jsx(h,{value:o.cover_image||"",onChange:s=>k({...o,cover_image:s.target.value}),placeholder:"https://exemplo.com/imagem.jpg",type:"url"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Letras da M√∫sica"}),e.jsx(ne,{value:o.lyrics||"",onChange:s=>k({...o,lyrics:s.target.value}),placeholder:"Letras da m√∫sica...",rows:4})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:[e.jsxs(n,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700 text-lg py-3",children:[e.jsx(je,{className:"w-5 h-5 mr-2"}),"Salvar Altera√ß√µes"]}),e.jsx(n,{type:"button",onClick:()=>M(!1),variant:"outline",className:"flex-1 text-lg py-3",children:"Cancelar"})]})]})})]})})})]})})}function Bs({onBackToLogin:m}){const[c,j]=i.useState(""),[L,S]=i.useState(""),[u,t]=i.useState(!1),[p,V]=i.useState(!1),[v,N]=i.useState(!1),[y,_]=i.useState({type:"",text:""}),[O,I]=i.useState(!1);i.useEffect(()=>{new URLSearchParams(window.location.hash.split("?")[1]).get("reset")!=="true"&&m()},[m]);const g=async f=>{if(f.preventDefault(),N(!0),_({type:"",text:""}),c.length<6){_({type:"error",text:"Le mot de passe doit contenir au moins 6 caract√®res"}),N(!1);return}if(c!==L){_({type:"error",text:"Les mots de passe ne correspondent pas"}),N(!1);return}try{const{error:E}=await le.auth.updateUser({password:c});if(E)throw E;I(!0),_({type:"success",text:"Mot de passe mis √† jour avec succ√®s !"}),setTimeout(()=>{window.location.href="/#/admin"},2e3)}catch(E){console.error("Erreur update password:",E),_({type:"error",text:`Erreur: ${E.message}`})}finally{N(!1)}};return O?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsx(ve,{className:"w-full max-w-md",children:e.jsx(Ee,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Cs,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-2",children:"Mot de passe mis √† jour !"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Votre mot de passe a √©t√© mis √† jour avec succ√®s. Redirection vers l'Admin..."}),e.jsx(Ue,{className:"w-6 h-6 animate-spin mx-auto text-blue-600"})]})})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsxs(ve,{className:"w-full max-w-md",children:[e.jsxs(Oe,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ve,{className:"w-6 h-6 text-blue-600"})}),e.jsx(Be,{className:"text-2xl font-bold text-gray-900",children:"Nouveau mot de passe"}),e.jsx(ys,{children:"Entrez votre nouveau mot de passe"})]}),e.jsxs(Ee,{children:[e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[y.text&&e.jsx(Ls,{variant:y.type==="error"?"destructive":"default",children:e.jsx(As,{children:y.text})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Nouveau mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"password",type:u?"text":"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:c,onChange:f=>j(f.target.value),required:!0,disabled:v,className:"w-full pr-10"}),e.jsx("button",{type:"button",onClick:()=>t(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:u?e.jsx($e,{className:"w-4 h-4"}):e.jsx(ze,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Confirmer le mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"confirmPassword",type:p?"text":"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:L,onChange:f=>S(f.target.value),required:!0,disabled:v,className:"w-full pr-10"}),e.jsx("button",{type:"button",onClick:()=>V(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:p?e.jsx($e,{className:"w-4 h-4"}):e.jsx(ze,{className:"w-4 h-4"})})]})]}),e.jsx(n,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4 animate-spin mr-2"}),"Mise √† jour..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Mettre √† jour"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{onClick:m,className:"text-blue-600 hover:text-blue-700 font-medium",disabled:v,children:[e.jsx(Ms,{className:"w-4 h-4 inline mr-1"}),"Retour √† la connexion"]})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-800 text-center",children:"üîí Le mot de passe doit contenir au moins 6 caract√®res"})})]})]})})}function Zs(){const[m,c]=i.useState(!1),[j,L]=i.useState(!0),[S,u]=i.useState(!1),[t,p]=i.useState(!1);i.useEffect(()=>{let N=!0;(async()=>{await V()})(),new URLSearchParams(window.location.hash.split("?")[1]).get("reset")==="true"&&p(!0);const{data:{subscription:O}}=le.auth.onAuthStateChange(async(I,g)=>{I==="SIGNED_IN"&&g&&N?(c(!0),await v(g.user.id)):I==="SIGNED_OUT"&&N&&(c(!1),u(!1),L(!1))});return()=>{N=!1,O.unsubscribe()}},[]);const V=async()=>{try{console.warn("üîê Starting auth check...");const{data:{session:N},error:y}=await le.auth.getSession();if(y)throw console.error("‚ùå Session error:",y),y;N?(console.warn("‚úÖ Session found, checking admin status..."),c(!0),await v(N.user.id)):(console.warn("‚ö†Ô∏è No session found"),c(!1),u(!1))}catch(N){console.error("‚ùå Erreur v√©rification auth:",N),c(!1),u(!1)}finally{console.warn("üèÅ Auth check complete, setting loading to false"),L(!1)}},v=async N=>{let y;try{console.warn("üîç Checking admin status for user:",N);try{const{data:I,error:g}=await le.from("admins").select("user_id").limit(1);g&&g.code!=="PGRST116"?console.warn("‚ö†Ô∏è Test de connexion √† la table admins:",g.message):console.warn("‚úÖ Connexion √† la table admins OK")}catch(I){console.warn("‚ö†Ô∏è Erreur test connexion:",I.message)}const _=le.from("admins").select("user_id").eq("user_id",N).maybeSingle(),O=new Promise((I,g)=>{y=setTimeout(()=>{g(new Error("TIMEOUT: Admin check took too long (>10s)"))},1e4)});try{const I=await Promise.race([_.then(he=>(y&&clearTimeout(y),he)),O]),{data:g,error:f}=I;if(console.warn("üìä Admin check result:",{data:g,error:f,hasData:!!g}),f){if(f.code==="PGRST116"){console.warn("‚ö†Ô∏è User is NOT admin (no admin record found)"),u(!1);return}console.error("‚ùå Erreur v√©rification admin:",f.message,f.code,f),console.error("‚ùå D√©tails de l'erreur:",{message:f.message,code:f.code,details:f.details,hint:f.hint}),(f.code==="42501"||f.message?.includes("permission denied")||f.message?.includes("RLS"))&&(console.error("‚ùå ERREUR RLS: Les policies RLS ne sont pas correctement configur√©es pour la table admins"),console.error("‚ùå Solution: Ex√©cuter le script supabase/scripts/fix_admin_rls_complete.sql dans Supabase SQL Editor")),u(!1);return}const E=!!g;console.warn(E?"‚úÖ User IS admin":"‚ö†Ô∏è User is NOT admin"),u(E)}catch(I){throw y&&clearTimeout(y),I}}catch(_){y&&clearTimeout(y),console.error("‚ùå Exception v√©rification admin:",_.message||_),_.message?.includes("TIMEOUT")&&(console.error("‚ùå TIMEOUT: La v√©rification admin a pris trop de temps"),console.error("‚ùå Cela peut indiquer:"),console.error("   1. Un probl√®me de connexion √† Supabase"),console.error("   2. Un probl√®me de configuration RLS sur la table admins"),console.error("   3. Un probl√®me de r√©seau"),console.error("‚ùå SOLUTION: Ex√©cutez le script supabase/scripts/fix_admin_rls_complete.sql dans Supabase SQL Editor"),console.error("‚ùå En attendant, vous pouvez essayer de vous connecter - la v√©rification admin se fera apr√®s la connexion")),u(!1)}};return t?e.jsx(Bs,{onBackToLogin:()=>p(!1)}):j?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"V√©rification de l'acc√®s administrateur..."})]})}):m&&S?e.jsx(Os,{}):e.jsxs(e.Fragment,{children:[e.jsx(vs,{children:e.jsx("meta",{name:"robots",content:"noindex,nofollow"})}),e.jsx(Ps,{})]})}export{Zs as default};
