var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,s=(e,t,n)=>i(e,"symbol"!=typeof t?t+"":t,n);let o=-1;const a=e=>{addEventListener("pageshow",t=>{t.persisted&&(o=t.timeStamp,e(t))},!0)},l=(e,t,n,r)=>{let i,s;return o=>{var a,l;t.value>=0&&(o||r)&&(s=t.value-(null!=i?i:0),(s||void 0===i)&&(i=t.value,t.delta=s,t.rating=(a=t.value)>(l=n)[1]?"poor":a>l[0]?"needs-improvement":"good",e(t)))}},c=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},d=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},u=()=>{var e;const t=d();return null!=(e=null==t?void 0:t.activationStart)?e:0},h=(e,t=-1)=>{const n=d();let r="navigate";return o>=0?r="back-forward-cache":n&&(document.prerendering||u()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},p=new WeakMap;function m(e,t){return p.get(e)||p.set(e,new t),p.get(e)}class v{constructor(){s(this,"t"),s(this,"i",0),s(this,"o",[])}h(e){var t;if(e.hadRecentInput)return;const n=this.o[0],r=this.o.at(-1);this.i&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),null==(t=this.t)||t.call(this,e)}}const f=(e,s,o={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const a=new PerformanceObserver(e=>{Promise.resolve().then(()=>{s(e.getEntries())})});return a.observe(((e,s)=>{for(var o in s||(s={}))n.call(s,o)&&i(e,o,s[o]);if(t)for(var o of t(s))r.call(s,o)&&i(e,o,s[o]);return e})({type:e,buffered:!0},o)),a}}catch(a){}},g=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let y=-1;const T=new Set,b=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,P=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(const e of T)e();isFinite(y)||(y="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",P,!0))}},C=()=>{var e;if(y<0){const t=u(),n=document.prerendering||null==(e=globalThis.performance.getEntriesByType("visibility-state").filter(e=>"hidden"===e.name&&e.startTime>t)[0])?void 0:e.startTime;y=null!=n?n:b(),addEventListener("visibilitychange",P,!0),addEventListener("prerenderingchange",P,!0),a(()=>{setTimeout(()=>{y=b()})})}return{get firstHiddenTime(){return y},onHidden(e){T.add(e)}}},E=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},w=[1800,3e3],L=(e,t={})=>{E(()=>{const n=C();let r,i=h("FCP");const s=f("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(s.disconnect(),t.startTime<n.firstHiddenTime&&(i.value=Math.max(t.startTime-u(),0),i.entries.push(t),r(!0)))});s&&(r=l(e,i,w,t.reportAllChanges),a(n=>{i=h("FCP"),r=l(e,i,w,t.reportAllChanges),c(()=>{i.value=performance.now()-n.timeStamp,r(!0)})}))})},S=[.1,.25],A=(e,t={})=>{const n=C();L(g(()=>{let r,i=h("CLS",0);const s=m(t,v),o=e=>{for(const t of e)s.h(t);s.i>i.value&&(i.value=s.i,i.entries=s.o,r())},d=f("layout-shift",o);d&&(r=l(e,i,S,t.reportAllChanges),n.onHidden(()=>{o(d.takeRecords()),r(!0)}),a(()=>{s.i=0,i=h("CLS",0),r=l(e,i,S,t.reportAllChanges),c(()=>r())}),setTimeout(r))}))};let I=0,M=1/0,k=0;const O=e=>{for(const t of e)t.interactionId&&(M=Math.min(M,t.interactionId),k=Math.max(k,t.interactionId),I=k?(k-M)/7+1:0)};let F;const H=()=>{var e;return F?I:null!=(e=performance.interactionCount)?e:0};let x=0;class j{constructor(){s(this,"u",[]),s(this,"l",new Map),s(this,"m"),s(this,"p")}v(){x=H(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((H()-x)/50));return this.u[e]}h(e){var t,n;if(null==(t=this.m)||t.call(this,e),!e.interactionId&&"first-input"!==e.entryType)return;const r=this.u.at(-1);let i=this.l.get(e.interactionId);if(i||this.u.length<10||e.duration>r.P){if(i?e.duration>i.P?(i.entries=[e],i.P=e.duration):e.duration===i.P&&e.startTime===i.entries[0].startTime&&i.entries.push(e):(i={id:e.interactionId,entries:[e],P:e.duration},this.l.set(i.id,i),this.u.push(i)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}null==(n=this.p)||n.call(this,i)}}}const B=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=g(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},R=[200,500],q=(e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=C();E(()=>{var r;"interactionCount"in performance||F||(F=f("event",O,{type:"event",buffered:!0,durationThreshold:0}));let i,s=h("INP");const o=m(t,j),c=e=>{B(()=>{for(const n of e)o.h(n);const t=o.L();t&&t.P!==s.value&&(s.value=t.P,s.entries=t.entries,i())})},d=f("event",c,{durationThreshold:null!=(r=t.durationThreshold)?r:40});i=l(e,s,R,t.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{c(d.takeRecords()),i(!0)}),a(()=>{o.v(),s=h("INP"),i=l(e,s,R,t.reportAllChanges)}))})};class D{constructor(){s(this,"m")}h(e){var t;null==(t=this.m)||t.call(this,e)}}const N=[2500,4e3],$=(e,t={})=>{E(()=>{const n=C();let r,i=h("LCP");const s=m(t,D),o=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)s.h(t),t.startTime<n.firstHiddenTime&&(i.value=Math.max(t.startTime-u(),0),i.entries=[t],r())},d=f("largest-contentful-paint",o);if(d){r=l(e,i,N,t.reportAllChanges);const n=g(()=>{o(d.takeRecords()),d.disconnect(),r(!0)}),s=e=>{e.isTrusted&&(B(n),removeEventListener(e.type,s,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])addEventListener(e,s,{capture:!0});a(n=>{i=h("LCP"),r=l(e,i,N,t.reportAllChanges),c(()=>{i.value=performance.now()-n.timeStamp,r(!0)})})}})},W=[800,1800],_=e=>{document.prerendering?E(()=>_(e)):"complete"!==document.readyState?addEventListener("load",()=>_(e),!0):setTimeout(e)},z=(e,t={})=>{let n=h("TTFB"),r=l(e,n,W,t.reportAllChanges);_(()=>{const i=d();i&&(n.value=Math.max(i.responseStart-u(),0),n.entries=[i],r(!0),a(()=>{n=h("TTFB",0),r=l(e,n,W,t.reportAllChanges),r(!0)}))})};export{z as $,L as E,A as L,q as S,$ as x};
