import{r as o,j as t,L as J}from"./vendor-react-NAV4UYoK.js";import{u as L,S as $}from"./index-Bz0l7afN.js";import{u as O,Y as M,P as R,n as V}from"./vendor-ui-BUbFcrva.js";import"./vendor-supabase-CMR6_zzL.js";import"./vendor-date-BfA9-vu0.js";const A=[{label:"Jan",full:"Janeiro",index:0,color:"#3B82F6"},{label:"Fev",full:"Fevereiro",index:1,color:"#6366F1"},{label:"Mar",full:"MarÃ§o",index:2,color:"#EC4899"},{label:"Abr",full:"Abril",index:3,color:"#F97316"},{label:"Mai",full:"Maio",index:4,color:"#10B981"},{label:"Jun",full:"Junho",index:5,color:"#EAB308"},{label:"Jul",full:"Julho",index:6,color:"#F59E0B"},{label:"Ago",full:"Agosto",index:7,color:"#EF4444"},{label:"Set",full:"Setembro",index:8,color:"#8B5CF6"},{label:"Out",full:"Outubro",index:9,color:"#14B8A6"},{label:"Nov",full:"Novembro",index:10,color:"#06B6D4"},{label:"Dez",full:"Dezembro",index:11,color:"#F43F5E"}];function b(a){if(!a)return null;const u=/^\d{4}-\d{2}-\d{2}$/.test(a)?a+"T12:00:00":a,n=new Date(u);return isNaN(n.getTime())?null:n}function g(a){return(a||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Z(a){return a?a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim():null}function Y(a){if(!a)return null;const u=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube-nocookie\.com\/embed\/|music\.youtube\.com\/watch\?v=)([a-zA-Z0-9_-]{11})/,/youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/];for(const n of u){const h=a.match(n);if(h)return h[1]}return null}function U(){L({title:"Pesquisar mÃºsicas - A MÃºsica da Segunda",description:"Encontre qualquer mÃºsica do projeto A MÃºsica da Segunda.",url:"/search",type:"website",robots:"noindex, follow"});const[a,u]=o.useState([]),[n,h]=o.useState(!0),[f,E]=o.useState(""),[x,v]=o.useState(new Set),[m,D]=o.useState(new Set),w=o.useRef(null),[S,z]=o.useState(null),[y,B]=o.useState(null),[k,j]=o.useState("stopped");o.useEffect(()=>{$.list("-release_date").then(e=>{const s=e||[];u(s);const l=new Set;s.forEach(i=>{const r=b(i.release_date);r&&l.add(r.getFullYear())}),v(l),h(!1)})},[]);const _=o.useMemo(()=>{const e=new Set;return a.forEach(s=>{const l=b(s.release_date);l&&e.add(l.getFullYear())}),[...e].sort((s,l)=>l-s)},[a]),d=o.useMemo(()=>{const e=g(f.trim()),s=e.length>0,l=x.size>0,i=m.size>0;return!s&&!l&&!i?[]:a.filter(r=>{const c=b(r.release_date),F=!s||g(r.title).includes(e)||g(r.artist).includes(e)||g(r.description).includes(e)||c&&String(c.getFullYear()).includes(e),p=!l||c&&x.has(c.getFullYear()),q=!i||c&&m.has(c.getMonth());return F&&p&&q})},[f,x,m,a]),N=f.trim().length>0||x.size>0||m.size>0,P=e=>{v(s=>{const l=new Set(s);return l.has(e)?l.delete(e):l.add(e),l})},T=e=>{D(s=>{const l=new Set(s);return l.has(e)?l.delete(e):l.add(e),l})},C=e=>{var s,l;(l=(s=w.current)==null?void 0:s.contentWindow)==null||l.postMessage(JSON.stringify({event:"command",func:e,args:[]}),"*")},I=e=>{const s=Y(e.youtube_url);s&&(S===e.id?k==="playing"?(C("pauseVideo"),j("paused")):(C("playVideo"),j("playing")):(z(e.id),B(s),j("playing")))};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-sky-50 via-white to-blue-50",children:[y&&t.jsx("iframe",{ref:w,src:`https://www.youtube-nocookie.com/embed/${y}?enablejsapi=1&autoplay=1&rel=0`,title:"player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",style:{position:"fixed",top:"-9999px",left:"-9999px",width:"1px",height:"1px",opacity:0,pointerEvents:"none"}},y),t.jsxs("div",{className:"text-center pt-6 pb-4 px-4",children:[t.jsx("h1",{className:"text-3xl font-black text-gray-800 tracking-tight",children:"Pesquisar"}),t.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Encontre uma mÃºsica do projeto"})]}),t.jsxs("div",{className:"max-w-2xl mx-auto px-4 pb-24",children:[t.jsxs("div",{className:"relative mb-5",children:[t.jsx(O,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"}),t.jsx("input",{type:"search",autoFocus:!0,value:f,onChange:e=>E(e.target.value),placeholder:"Pesquisar mÃºsica, artista, ano...",className:"w-full pl-12 pr-4 py-4 rounded-2xl border border-gray-200 bg-white shadow-sm text-gray-800 text-base focus:outline-none focus:ring-2 focus:ring-[#32a2dc]/40 focus:border-[#32a2dc] transition-all"})]}),_.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"Ano"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(e=>{const s=x.has(e);return t.jsx("button",{onClick:()=>P(e),className:"px-4 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:s?{backgroundColor:"#1a1a2e",borderColor:"#1a1a2e",color:"#fff"}:{backgroundColor:"#fff",borderColor:"#1a1a2e33",color:"#1a1a2e"},children:e},e)})})]}),t.jsxs("div",{className:"mb-5",children:[t.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-widest font-semibold mb-2 px-1",children:"MÃªs"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(e=>{const s=m.has(e.index);return t.jsx("button",{onClick:()=>T(e.index),title:e.full,className:"px-3 py-1.5 rounded-xl text-xs font-bold transition-all duration-200 border-2",style:s?{backgroundColor:e.color,borderColor:e.color,color:"#fff"}:{backgroundColor:"#fff",borderColor:e.color+"55",color:e.color},children:e.label},e.index)})})]}),N&&!n&&t.jsx("p",{className:"text-xs text-gray-400 mb-4 px-1",children:d.length===0?"Nenhuma mÃºsica encontrada":`${d.length} mÃºsica${d.length>1?"s":""} encontrada${d.length>1?"s":""}`}),n&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[#32a2dc] border-t-transparent rounded-full animate-spin"})}),!n&&!N&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-300",children:[t.jsx(M,{className:"w-16 h-16 mb-4"}),t.jsx("p",{className:"text-base font-medium text-center",children:"Digite uma palavra ou escolha um mÃªs"})]}),!n&&N&&d.length>0&&t.jsx("div",{className:"space-y-3",children:d.map(e=>{const s=Z(e.title),l=b(e.release_date),i=l?l.getMonth():null,r=i!==null?A[i].color:"#32a2dc",c=Y(e.youtube_url),p=S===e.id&&k==="playing";return t.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"h-1 w-full",style:{backgroundColor:r}}),t.jsxs("div",{className:"px-5 py-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:r+"18"},children:t.jsx(M,{className:"w-4 h-4",style:{color:r}})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"min-w-0 flex-1",children:s?t.jsx(J,{to:`/musica/${s}/`,className:"text-base font-black text-gray-800 hover:text-[#32a2dc] transition-colors leading-tight block truncate",children:e.title}):t.jsx("p",{className:"text-base font-black text-gray-800 leading-tight truncate",children:e.title})}),c&&t.jsx("button",{onClick:()=>I(e),className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110 shadow-sm",style:{backgroundColor:p?r:r+"22"},"aria-label":p?"Pausar":"Tocar",children:p?t.jsx(R,{className:"w-3.5 h-3.5 text-white"}):t.jsx(V,{className:"w-3.5 h-3.5 ml-0.5",style:{color:r}})})]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[e.artist,l&&t.jsxs("span",{className:"text-gray-400 ml-2",children:["Â· ",l.toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"})]})]})]})]}),e.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-2 leading-relaxed line-clamp-3 pl-12",children:e.description}),(e.spotify_url||e.youtube_music_url||e.apple_music_url)&&t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pl-12",children:[e.spotify_url&&t.jsx("a",{href:e.spotify_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-[#1DB954]/10 text-[#1DB954] text-xs font-bold hover:bg-[#1DB954]/20 transition-colors",children:"ðŸŽ§ Spotify"}),e.apple_music_url&&t.jsx("a",{href:e.apple_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-pink-50 text-pink-600 text-xs font-bold hover:bg-pink-100 transition-colors",children:"ðŸŽµ Apple Music"}),e.youtube_music_url&&t.jsx("a",{href:e.youtube_music_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-red-50 text-red-600 text-xs font-bold hover:bg-red-100 transition-colors",children:"ðŸ“± Video"})]})]})]},e.id)})})]})]})}export{U as default};
