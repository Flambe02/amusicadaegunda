import{c as v,r as t,j as e,P as N,R as P,a as R,u as I,b as A,B as j}from"./index-SY1DnotX.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],S=v("ArrowLeft",L);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$=v("Settings",V);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],_=v("Volume2",q);function D({postId:n,controls:d=0,autoPlay:o=!0,className:u=""}){const r=t.useRef(null),i=t.useRef(null),[m,h]=t.useState(!0),[x,c]=t.useState(null),[b,g]=t.useState(!0),[l,C]=t.useState(!1),[k,w]=t.useState(!1),y=t.useCallback(s=>{if(s.origin!=="https://www.tiktok.com"){console.warn("TikTok player: message rejeté depuis une origine non autorisée:",s.origin);return}try{const a=s.data;if(!a||typeof a!="object"||!a.event){console.warn("TikTok player: données de message invalides:",a);return}switch(a.event){case"onPlayerReady":console.log("TikTok player ready"),w(!0),h(!1);break;case"onStateChange":a.info===0&&(console.log("Video ended, restarting loop"),k&&(p("seekTo",0),setTimeout(()=>p("play"),100)));break;case"onMute":g(a.info===1);break;case"onError":console.error("TikTok player error:",a.info),c("Erro no player TikTok");break;default:console.debug("TikTok player: événement non géré:",a.event)}}catch(a){console.warn("Error parsing TikTok message:",a)}},[k]),p=t.useCallback((s,a)=>{var f;if(i.current&&k)try{(f=i.current.contentWindow)==null||f.postMessage({method:s,value:a},"https://www.tiktok.com")}catch(M){console.error("TikTok player: erreur lors de l'envoi du message:",M)}},[k]),E=t.useCallback(()=>{var s,a;if(g(!1),p("unMute"),p("seekTo",0),p("play"),i.current)try{(s=i.current.contentWindow)==null||s.postMessage({method:"unMute",value:0},"https://www.tiktok.com"),(a=i.current.contentWindow)==null||a.postMessage({method:"play",value:0},"https://www.tiktok.com")}catch(f){console.log("Impossible de forcer la lecture avec son:",f)}},[p]),F=t.useCallback(()=>{var s,a;l?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():(s=r.current)!=null&&s.requestFullscreen?r.current.requestFullscreen():(a=r.current)!=null&&a.webkitRequestFullscreen&&r.current.webkitRequestFullscreen()},[l]);return t.useEffect(()=>{const s=()=>{C(!!document.fullscreenElement||!!document.webkitFullscreenElement)};return document.addEventListener("fullscreenchange",s),document.addEventListener("webkitfullscreenchange",s),()=>{document.removeEventListener("fullscreenchange",s),document.removeEventListener("webkitfullscreenchange",s)}},[]),t.useEffect(()=>(window.addEventListener("message",y),()=>window.removeEventListener("message",y)),[y]),t.useEffect(()=>{if(!n||!r.current)return;h(!0),c(null),w(!1),r.current.innerHTML="";const s=document.createElement("iframe");s.src=`https://www.tiktok.com/player/v1/${n}?autoplay=${o?1:0}&loop=1&controls=${d}&rel=0&muted=0&ratio=9:16`,s.title="TikTok Video Player",s.allowFullscreen=!0,s.allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; gyroscope",s.style.cssText=`
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 16px;
      background: #000;
      overflow: hidden;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      /* Forcer le format 9:16 et supprimer l'écran blanc */
      object-fit: cover;
      object-position: center;
    `,s.onload=()=>{console.log("TikTok iframe loaded")},s.onerror=()=>{console.error("TikTok iframe failed to load"),c("Erro ao carregar vídeo TikTok"),h(!1)},r.current.appendChild(s),i.current=s;const a=setTimeout(()=>{m&&!k&&(console.warn("TikTok player timeout"),c("Timeout ao carregar TikTok"),h(!1))},15e3);return()=>{clearTimeout(a),r.current&&(r.current.innerHTML="")}},[n,o,d]),n?e.jsxs("div",{ref:r,className:`tiktok-player-container ${u} ${l?"fullscreen":""}`,children:[m&&e.jsxs("div",{className:"tiktok-player-loading",children:[e.jsx("div",{className:"loading-spinner",children:e.jsx(P,{className:"w-8 h-8 animate-spin text-[#FF0050]"})}),e.jsx("p",{className:"loading-text",children:"Carregando TikTok..."})]}),x&&e.jsx("div",{className:"tiktok-player-error",children:e.jsxs("div",{className:"error-content",children:[e.jsx("div",{className:"error-icon",children:"⚠️"}),e.jsx("h3",{className:"error-title",children:"Erro ao carregar"}),e.jsx("p",{className:"error-message",children:x}),e.jsx("div",{className:"error-actions",children:e.jsx("button",{onClick:()=>window.open(`https://www.tiktok.com/@user/video/${n}`,"_blank"),className:"fallback-link",children:"Abrir no TikTok"})})]})}),!m&&!x&&b&&e.jsx("div",{className:"tiktok-player-overlay",children:e.jsxs("button",{onClick:E,className:"unmute-button","aria-label":"Ativar o som e reproduzir vídeo","aria-pressed":"false",children:[e.jsx(_,{className:"w-6 h-6"}),e.jsx("span",{children:"Ativar Som"})]})}),!m&&!x&&e.jsx("button",{onClick:F,className:"fullscreen-button","aria-label":l?"Sair da tela cheia":"Tela cheia","aria-pressed":l,children:"⛶"})]}):e.jsx("div",{className:`tiktok-player-fallback ${u}`,children:e.jsxs("div",{className:"fallback-content",children:[e.jsx(N,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Vídeo TikTok não disponível"}),e.jsx("p",{className:"text-gray-500 text-sm text-center",children:"ID da vídeo não fornecido ou inválido"})]})})}const T=t.forwardRef(({className:n,type:d,...o},u)=>e.jsx("input",{type:d,className:R("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:u,...o}));T.displayName="Input";function H(){const{id:n}=I(),d=A(),[o,u]=t.useState(n||""),[r,i]=t.useState(0),[m,h]=t.useState(!0),x=n||"7467353900979424534",c=o||x,b=()=>{o.trim()&&d(`/tiktok/${o.trim()}`)},g=()=>{d("/")};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-blue-100 p-4",children:[e.jsxs("div",{className:"max-w-4xl mx-auto mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(j,{variant:"ghost",onClick:g,className:"text-gray-600 hover:text-gray-800",children:[e.jsx(S,{className:"w-5 h-5 mr-2"}),"Voltar"]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-black text-gray-800 mb-2",children:"TikTok Player Demo"}),e.jsx("p",{className:"text-gray-600",children:"Teste o player TikTok robusto com mobile-first, autoplay muted, e plein écran"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID da Vídeo TikTok"}),e.jsx(T,{type:"text",value:o,onChange:l=>u(l.target.value),placeholder:"Ex: 7467353900979424534",className:"w-full"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{onClick:b,disabled:!o.trim(),className:"bg-[#FF0050] hover:bg-[#E6004C] text-white",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Testar Vídeo"]}),e.jsx(j,{variant:"outline",onClick:()=>u(x),className:"border-gray-300 text-gray-700",children:"Reset"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r===1,onChange:l=>i(l.target.checked?1:0),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Controles visíveis"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:l=>h(l.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Autoplay"})]})]})})]})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Player TikTok - ",c]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID atual: ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:c})]})]}),e.jsx("div",{className:"relative w-full mx-auto",style:{maxWidth:"350px"},children:e.jsx("div",{style:{aspectRatio:"9/16"},children:e.jsx(D,{postId:c,controls:r,autoPlay:m,className:"w-full h-full"})})})]})}),e.jsx("div",{className:"max-w-4xl mx-auto mt-6",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Funcionalidades Técnicas"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"✅ Implementado"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsx("li",{children:"• Autoplay muted par défaut"}),e.jsx("li",{children:'• Overlay "Activer le son" accessible'}),e.jsx("li",{children:"• Loop automatique en fin de vidéo"}),e.jsx("li",{children:"• Plein écran mobile (100svh, safe-areas)"}),e.jsx("li",{children:"• PostMessage API pour contrôler la lecture"}),e.jsx("li",{children:"• Fallback robuste en cas de blocage"}),e.jsx("li",{children:"• Mobile-first responsive design"}),e.jsx("li",{children:"• Accessibilité ARIA complète"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"🔧 API TikTok v1"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsxs("li",{children:["• URL: ",e.jsxs("code",{className:"bg-gray-100 px-1 rounded",children:["/player/v1/","{ID}"]})]}),e.jsx("li",{children:"• Paramètres: autoplay, loop, controls, muted"}),e.jsx("li",{children:"• PostMessage: onPlayerReady, onStateChange"}),e.jsx("li",{children:"• Commands: play, pause, seekTo, unMute"})]})]})]})]})})]})}export{H as default};
