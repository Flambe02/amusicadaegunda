var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;import{j as o,r as n,C as c,c as d,K as u,X as m,M as x,N as h,F as g,S as p,I as f,d as b,e as y}from"./vendor-BIbFW3qO.js";import{L as w,D as j,a as v,b as N,c as M,S as _,u as S,B as k,d as C}from"./index-DetkHvaz.js";import{p as D,f as $,b as O,g as A,e as P,d as z,h as E,s as L,a as F}from"./utils-DuUtq9wc.js";import"./libs-DY7TBn7z.js";import"./ui-CttiZxwU.js";import"./supabase-sfbdw4k8.js";function q(e){var n,c=e,{children:d}=c,u=((e,s)=>{var t={};for(var i in e)r.call(e,i)&&s.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&a)for(var i of a(e))s.indexOf(i)<0&&l.call(e,i)&&(t[i]=e[i]);return t})(c,["children"]);return o.jsx("span",(n=((e,s)=>{for(var t in s||(s={}))r.call(s,t)&&i(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&i(e,t,s[t]);return e})({},u),s(n,t({className:"sr-only",style:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"},children:d}))))}function R({youtube_music_url:e,youtube_url:s,title:t}){const a=e||s||"",r=(e=>{if(!e||"string"!=typeof e)return null;try{const s=e.match(/[?&]list=([A-Za-z0-9_-]+)/);if(s)return{id:s[1],type:"playlist"};const t=[/(?:youtube\.com\/shorts\/)([A-Za-z0-9_-]{11})/,/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([A-Za-z0-9_-]{11})/,/^([A-Za-z0-9_-]{11})$/];for(const a of t){const s=e.match(a);if(s)return{id:s[1],type:"video"}}if(e.toLowerCase().includes("music.youtube.com")){const s=e.match(/[?&]v=([A-Za-z0-9_-]{11})/);if(s)return{id:s[1],type:"video"}}return null}catch(s){return null}})(a);if(!r)return o.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden shadow-lg flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:o.jsx("p",{className:"text-white text-sm",children:"Vidéo non disponible"})});const l=a.includes("/shorts/"),i="https://www.youtube-nocookie.com/embed",n="video"===r.type?`${i}/${r.id}?rel=0&modestbranding=1&playsinline=1&controls=1`:`${i}/videoseries?list=${r.id}&rel=0&modestbranding=1&playsinline=1&controls=1`;return l?o.jsx("div",{className:"relative rounded-lg overflow-hidden shadow-2xl",style:{width:"100%",aspectRatio:"9/16",minHeight:"min(500px, 70vh)",maxHeight:"70vh"},children:o.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full",src:n,title:t||"YouTube Short",frameBorder:"0",referrerPolicy:"strict-origin-when-cross-origin",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}):o.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden shadow-lg",children:o.jsx("iframe",{className:"w-full h-full",src:n,title:t||"YouTube",frameBorder:"0",referrerPolicy:"strict-origin-when-cross-origin",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})})}function Y({song:e,onClose:s,onShowDescription:t}){const[a,r]=n.useState(!1),[l,i]=n.useState(!1),[b,y]=n.useState(!1),_=n.useRef(null);if(n.useEffect(()=>{const e=e=>{_.current&&!_.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),!e||!e.id||!e.title)return o.jsxs("div",{className:"bg-white rounded-2xl p-6 text-center text-gray-500",children:[o.jsx("div",{className:"mb-4",children:o.jsx(c,{className:"w-12 h-12 text-red-400 mx-auto"})}),o.jsx("p",{className:"text-lg font-medium mb-2",children:"Erro ao carregar música"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Dados da música inválidos ou incompletos"}),s&&o.jsx("button",{onClick:s,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors",children:"Fechar"})]});const S=[];return e.spotify_url&&S.push({name:"Spotify",url:e.spotify_url,icon:d,color:"bg-green-500"}),e.apple_music_url&&S.push({name:"Apple Music",url:e.apple_music_url,icon:d,color:"bg-pink-500"}),e.youtube_url&&S.push({name:"YouTube",url:e.youtube_url,icon:u,color:"bg-red-500"}),o.jsxs("div",{className:"relative w-full",children:[s&&o.jsx("button",{onClick:s,className:"absolute top-2 right-2 z-50 w-10 h-10 bg-black/50 hover:bg-black/70 backdrop-blur-sm rounded-full flex items-center justify-center transition-all duration-200 shadow-lg","aria-label":"Fermer",children:o.jsx(m,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{className:"space-y-3",children:[(e.youtube_music_url||e.youtube_url)&&o.jsxs("div",{className:"relative",children:[o.jsx(R,{youtube_music_url:e.youtube_music_url,youtube_url:e.youtube_url,title:e.title}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent p-4 pt-8",children:[o.jsx("h2",{className:"text-white font-bold text-lg leading-tight drop-shadow-lg mb-1",children:e.title}),o.jsx("p",{className:"text-white/90 text-sm font-medium drop-shadow-md",children:new Date(e.release_date).toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"})})]})]}),o.jsx("div",{className:"bg-white/95 backdrop-blur-md rounded-2xl shadow-xl p-3",children:o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{className:"relative",ref:_,children:[o.jsxs("button",{className:"w-full bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-3 px-2 rounded-xl font-bold transition-all duration-200 flex flex-col items-center justify-center space-y-1 shadow-lg hover:shadow-xl transform hover:scale-105",onClick:()=>y(!b),children:[o.jsx(x,{className:"w-5 h-5"}),o.jsx("span",{className:"text-xs",children:"Ouvir"}),S.length>0&&o.jsx("span",{className:"absolute -top-1 -right-1 text-xs bg-red-500 text-white w-5 h-5 rounded-full flex items-center justify-center font-bold shadow-md",children:S.length})]}),b&&o.jsx("div",{className:"absolute bottom-full left-0 right-auto mb-2 w-64 bg-white rounded-xl shadow-2xl border border-gray-200 p-3 z-50",children:S.length>0?o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs text-gray-500 font-bold mb-2 uppercase",children:"Disponível em:"}),S.map((e,s)=>o.jsxs("button",{onClick:()=>{var s;(s=e.url)&&window.open(s,"_blank","noopener,noreferrer")},className:"w-full flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 transition-colors text-left group",children:[o.jsx("div",{className:`w-10 h-10 rounded-lg ${e.color} flex items-center justify-center shadow-md group-hover:scale-110 transition-transform`,children:o.jsx(e.icon,{className:"w-5 h-5 text-white"})}),o.jsx("span",{className:"text-sm font-bold text-gray-800 flex-1",children:e.name}),o.jsx(h,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600"})]},s))]}):o.jsxs("div",{className:"text-center py-3",children:[o.jsx(x,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Nenhuma plataforma"})]})})]}),e.lyrics&&e.lyrics.trim()?o.jsxs("button",{onClick:()=>r(!0),className:"w-full bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white py-3 px-2 rounded-xl font-bold transition-all duration-200 flex flex-col items-center justify-center space-y-1 shadow-lg hover:shadow-xl transform hover:scale-105",children:[o.jsx(g,{className:"w-5 h-5"}),o.jsx("span",{className:"text-xs",children:"Letras"})]}):o.jsxs("button",{disabled:!0,className:"w-full bg-gray-200 text-gray-400 py-3 px-2 rounded-xl font-bold flex flex-col items-center justify-center space-y-1 opacity-50 cursor-not-allowed",children:[o.jsx(g,{className:"w-5 h-5"}),o.jsx("span",{className:"text-xs",children:"Letras"})]}),o.jsxs("button",{className:"w-full bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white py-3 px-2 rounded-xl font-bold transition-all duration-200 flex flex-col items-center justify-center space-y-1 shadow-lg hover:shadow-xl transform hover:scale-105",children:[o.jsx(p,{className:"w-5 h-5"}),o.jsx("span",{className:"text-xs",children:"Partager"})]})]})})]}),o.jsx(w,{open:a,onOpenChange:r,song:e,title:"Letras da Música",maxHeight:"h-64"}),o.jsx(j,{open:l,onOpenChange:i,children:o.jsxs(v,{className:"max-w-md",children:[o.jsx(N,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(M,{className:"flex items-center space-x-2",children:[o.jsx(f,{className:"w-5 h-5 text-blue-500"}),o.jsx("span",{children:"Descrição da Música"})]}),o.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(m,{className:"w-5 h-5"})})]})}),o.jsx("div",{className:"mt-4",children:o.jsx("p",{className:"text-gray-700 leading-relaxed font-sans text-sm",children:e.description||"Nenhuma descrição disponível para esta música."})})]})})]})}function Z(){const[e,s]=n.useState([]),[t,a]=n.useState(new Date),[r,l]=n.useState(null),[i,c]=n.useState(!0);n.useEffect(()=>{let e=new URLSearchParams(window.location.search).get("month");if(!e){const s=window.location.search;if(s.includes("?/")){const t=s.split("?/")[1];if(t.includes("?")){const s=t.split("?")[1];e=new URLSearchParams(s).get("month")}}}if(e)try{const[s,t]=e.split("-").map(Number);s&&void 0!==t&&a(new Date(s,t-1,1))}catch(s){}},[]);const u=n.useCallback(()=>{return e=function*(){try{c(!0);const e=t.getFullYear(),a=t.getMonth()+1,r=yield _.list("-release_date",null),l=(Array.isArray(r)?r:[]).filter(s=>{const t=D(s.release_date);return t.getFullYear()===e&&t.getMonth()+1===a});l.sort((e,s)=>D(s.release_date)-D(e.release_date)),s(l)}catch(e){s([])}finally{c(!1)}},new Promise((s,t)=>{var a=s=>{try{l(e.next(s))}catch(a){t(a)}},r=s=>{try{l(e.throw(s))}catch(a){t(a)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(a,r);l((e=e.apply(null,null)).next())});var e},[t]);n.useEffect(()=>{u()},[u]);const m=s=>e.find(e=>{const t=D(e.release_date);return O(t,s)}),h=e=>{a(s=>{const t=new Date(s);return t.setMonth(s.getMonth()+e),t})},g=e=>1===A(e),p=e=>{const s=m(e),t=O(e,new Date),a=g(e);let r="aspect-square flex flex-col items-center justify-center rounded-2xl text-sm font-bold transition-all duration-300 ";return s?"published"===s.status?r+="bg-[#32a2dc] text-white shadow-lg cursor-pointer hover:shadow-xl transform hover:scale-105 ":"draft"===s.status?r+="bg-orange-500 text-white shadow-lg cursor-pointer hover:shadow-xl transform hover:scale-105 ":r+="bg-gray-500 text-white shadow-lg cursor-pointer hover:shadow-xl transform hover:scale-105 ":r+=a?"bg-white/40 text-gray-600 border-2 border-dashed border-gray-400 ":"bg-white/20 text-gray-500 ",t&&(r+="ring-2 ring-white ring-opacity-60 "),r},f=$(t,"MMMM yyyy",{locale:F}),w=e.length;if(S({title:`Calendário Musical ${f}`,description:`Explore ${w} descobertas musicais de ${f}. Calendário completo das músicas da segunda no Música da Segunda.`,keywords:`calendário musical, ${f}, descobertas musicais, ${w} músicas, música da segunda, playlist mensal`,url:"/calendar",type:"website"}),i)return o.jsxs("div",{className:"p-5 max-w-md mx-auto animate-pulse",children:[o.jsx("div",{className:"h-12 bg-white/30 rounded-2xl mb-6"}),o.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:Array(42).fill(0).map((e,s)=>o.jsx("div",{className:"aspect-square bg-white/30 rounded-2xl"},s))})]});const N=(()=>{const e=(e=>{const s=L(e),t=A(s);return z(s,-t)})(t),s=P(t),a=A(s),r=z(s,6-a);return E({start:e,end:r})})(),R=e=>{e&&e.id&&e.title&&l(e)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-5 max-w-md mx-auto",children:[o.jsx("div",{className:"lg:hidden text-center mb-8",children:o.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-4 border-white/20 shadow-xl flex-shrink-0",children:o.jsx("img",{src:"images/Musica da segunda.jpg",alt:"Logo Música da Segunda",className:"w-full h-full object-cover"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-black text-white drop-shadow-lg mb-1",children:"Agenda Musical"}),o.jsx("p",{className:"text-white/80 font-medium text-sm md:text-base drop-shadow-md",children:"Acompanhe todas as músicas da segunda"})]})]})}),o.jsxs("div",{className:"bg-[#f8f5f2] rounded-3xl p-5 shadow-xl mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx(k,{variant:"ghost",size:"icon",onClick:()=>h(-1),className:"text-gray-600 hover:text-gray-800 hover:bg-white/60",children:o.jsx(b,{className:"w-5 h-5"})}),o.jsx("h2",{className:"text-2xl font-black text-gray-800 capitalize",children:$(t,"MMMM yyyy",{locale:F})}),o.jsx(k,{variant:"ghost",size:"icon",onClick:()=>h(1),className:"text-gray-600 hover:text-gray-800 hover:bg-white/60",children:o.jsx(y,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(e=>o.jsx("div",{className:"text-center text-xs font-bold text-gray-500 py-2",children:e},e))}),o.jsx("div",{className:"grid grid-cols-7 gap-2",children:N.map(e=>{const s=m(e),a=g(e),r=e.getMonth()===t.getMonth();return o.jsxs("div",{className:`${p(e)} ${r?"":"opacity-40"}`,onClick:()=>s&&R(s),children:[o.jsx("span",{className:"text-xs",children:$(e,"d")}),s&&o.jsxs("div",{className:"flex flex-col items-center mt-1",children:[o.jsx(x,{className:"w-3 h-3"}),"draft"===s.status&&o.jsx("div",{className:"w-1 h-1 bg-white rounded-full mt-1 opacity-80"})]}),a&&!s&&r&&o.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mt-1 opacity-60"})]},e.toISOString())})}),o.jsxs("div",{className:"mt-6 space-y-2 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-[#32a2dc] rounded-lg"}),o.jsx("span",{className:"text-gray-600 font-medium",children:"Música publicada"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 bg-white/40 border-2 border-dashed border-gray-400 rounded-lg"}),o.jsx("span",{className:"text-gray-600 font-medium",children:"Segunda-feira (aguardando)"})]}),r&&o.jsxs("div",{className:"text-xs text-gray-500 mt-2 p-2 bg-white/40 rounded-lg",children:[o.jsx("p",{className:"font-semibold",children:$(D(r.release_date),"dd 'de' MMMM 'de' yyyy - EEEE",{locale:F})}),o.jsxs("p",{children:[r.title," - ",r.artist]}),o.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Status: ","published"===r.status?"Publicada":"draft"===r.status?"Rascunho":"Arquivada"]})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-xl font-bold text-white drop-shadow-lg",children:"Músicas do Mês"}),(()=>{const s=e.filter(e=>{const s=D(e.release_date);return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()});return 0===s.length?o.jsxs("div",{className:"bg-[#f8f5f2] rounded-2xl p-6 text-center shadow-lg",children:[o.jsx(x,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),o.jsxs("p",{className:"text-gray-600 font-medium",children:["Nenhuma música publicada em ",$(t,"MMMM yyyy",{locale:F})]}),o.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"As músicas aparecerão aqui quando forem publicadas"})]}):s.map(e=>o.jsxs("div",{className:"bg-[#f8f5f2] rounded-2xl p-4 shadow-lg flex items-center gap-4 cursor-pointer hover:shadow-xl transition-all duration-300",onClick:()=>R(e),children:[o.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+("published"===e.status?"bg-[#32a2dc]":"draft"===e.status?"bg-orange-500":"bg-gray-500"),children:o.jsx(d,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{className:"flex-grow",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("p",{className:"font-bold text-gray-800",children:e.title}),o.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("published"===e.status?"bg-green-100 text-green-800":"draft"===e.status?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"),children:"published"===e.status?"Publicada":"draft"===e.status?"Rascunho":"Arquivada"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:e.artist}),o.jsx("p",{className:"text-xs text-gray-400",children:$(D(e.release_date),"dd/MM/yyyy")})]})]},e.id))})()]})]}),o.jsx(j,{open:!!r,onOpenChange:e=>!e&&l(null),children:o.jsxs(v,{className:"max-w-[min(95vw,420px)] p-0 gap-0 border-0 bg-transparent max-h-[95vh] overflow-y-auto [&>button]:hidden",children:[o.jsx(M,{asChild:!0,children:o.jsx(q,{children:r?`${r.title} - ${r.artist}`:"Détails de la musique"})}),o.jsx(C,{asChild:!0,children:o.jsx(q,{children:r?`Détails de la musique ${r.title} par ${r.artist}`:"Détails de la musique"})}),o.jsx(Y,{song:r,onClose:()=>l(null),onShowDescription:e=>{}})]})})]})}export{Z as default};
